<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Userspace Resource Manager: Extension Interface Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Userspace Resource Manager
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('extensions_usage.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Extension Interface Guide</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Refer <a class="el" href="Plugin_8cpp_source.html">Plugin.cpp</a> in Examples section, for basic code-guidance.</p>
<h1><a class="anchor" id="autotoc_md80"></a>
1. Making Use of Extensions Interface</h1>
<p><a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Tuner's Extension Interface exposes macros that can be used to customize callbacks and Configs. To make use of this capability client's need to create a shared library, called libPlugin.so and place it at /etc/urm/custom. This library should contain all the customization logic. This strategy allows the Clients to keep their code wherever they want. The only constraints are in terms of library naming, and library location.</p>
<p>Refer <a class="el" href="Plugin_8cpp_source.html">Plugin.cpp</a> for instructions on building the lib. Note, the lib must have appropriate permissions so that <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Tuner can read it.</p>
<h1><a class="anchor" id="autotoc_md81"></a>
2. Applier and Teardown Callbacks</h1>
<p><a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Tuner's Extension Interface allows for users to specify Custom Appliers and Teardown Callbacks for each <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a>. <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Tuner will provide default Applier and Teardown callbacks, but hte user can override them as per their needs.</p>
<p>=&gt; Applier Callback: This callback is called when a <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a> to tune a <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> is about to be applied. The default applier writes the configured value to the associated <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> (sysfs / procfs, cgroup etc.) Node.</p>
<p>=&gt; Teardown Callback: This callback is called when the currently applied <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a> for a <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> expires and there are no other Pending Requests. The default teardown callback resets the <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Node value to its original value.</p>
<p>Using the Extensions Interface, Users can easily extend the <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Tuner's functionality to tune New Resources and apply their own Custom Logic for Applier and Teardown Callbacks.</p>
<p>The following examples shows a sample custom Applier callback for <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> with the ResCode: 0x00090005.</p>
<div class="fragment"><div class="line">ResourceConfigs:</div>
<div class="line">  - ResType: &quot;0x09&quot;</div>
<div class="line">    ResID: &quot;0x0005&quot;</div>
<div class="line">    Name: &quot;RES_TUNER_CGROUP_LIMIT_CPU_TIME&quot;</div>
<div class="line">    Path: &quot;/sys/fs/cgroup/%s/cpu.max&quot;</div>
<div class="line">    Supported: true</div>
<div class="line">    Permissions: &quot;system&quot;</div>
<div class="line">    ApplyType: &quot;cgroup&quot;</div>
<div class="line">    Policy: higher_is_better</div>
</div><!-- fragment --><p><br  />
</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> limitCpuTime(<span class="keywordtype">void</span>* context) {</div>
<div class="line">    <span class="keywordflow">if</span>(context == <span class="keyword">nullptr</span>) <span class="keywordflow">return</span>;</div>
<div class="line">    <a class="code hl_class" href="classResource.html">Resource</a>* resource = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="classResource.html">Resource</a>*<span class="keyword">&gt;</span>(context);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span>(resource-&gt;getValuesCount() != 3) <span class="keywordflow">return</span>;</div>
<div class="line">    <span class="keywordflow">if</span>(resource-&gt;<a class="code hl_variable" href="classResource.html#a8d0f13af3594238d22d241aa83cbc1d5">mResValue</a>.<a class="code hl_variable" href="classResource.html#adf8c1d9a41a75b6bca752c6d85eba98b">values</a> == <span class="keyword">nullptr</span>) <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">    int32_t cGroupIdentifier = (*resource-&gt;<a class="code hl_variable" href="classResource.html#a8d0f13af3594238d22d241aa83cbc1d5">mResValue</a>.<a class="code hl_variable" href="classResource.html#adf8c1d9a41a75b6bca752c6d85eba98b">values</a>)[0];</div>
<div class="line">    int32_t maxUsageMicroseconds = (*resource-&gt;<a class="code hl_variable" href="classResource.html#a8d0f13af3594238d22d241aa83cbc1d5">mResValue</a>.<a class="code hl_variable" href="classResource.html#adf8c1d9a41a75b6bca752c6d85eba98b">values</a>)[1];</div>
<div class="line">    int32_t periodMicroseconds = (*resource-&gt;<a class="code hl_variable" href="classResource.html#a8d0f13af3594238d22d241aa83cbc1d5">mResValue</a>.<a class="code hl_variable" href="classResource.html#adf8c1d9a41a75b6bca752c6d85eba98b">values</a>)[2];</div>
<div class="line">    <a class="code hl_struct" href="structCGroupConfigInfo.html">CGroupConfigInfo</a>* cGroupConfig = TargetRegistry::getInstance()-&gt;getCGroupConfig(cGroupIdentifier);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span>(cGroupConfig != <span class="keyword">nullptr</span>) {</div>
<div class="line">        <span class="keyword">const</span> std::string cGroupName = cGroupConfig-&gt;<a class="code hl_variable" href="structCGroupConfigInfo.html#aea13059e491061d0d2d09862f7fef189">mCgroupName</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span>(cGroupName.length() &gt; 0) {</div>
<div class="line">            std::string controllerFilePath = getCGroupTypeResourceNodePath(resource, cGroupName);</div>
<div class="line">            std::ofstream controllerFile(controllerFilePath);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span>(!controllerFile.is_open()) {</div>
<div class="line">                TYPELOGV(ERRNO_LOG, <span class="stringliteral">&quot;open&quot;</span>, strerror(errno));</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            controllerFile&lt;&lt;maxUsageMicroseconds&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;periodMicroseconds&lt;&lt;std::endl;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span>(controllerFile.fail()) {</div>
<div class="line">                TYPELOGV(ERRNO_LOG, <span class="stringliteral">&quot;write&quot;</span>, strerror(errno));</div>
<div class="line">            }</div>
<div class="line">            controllerFile.close();</div>
<div class="line">        }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        TYPELOGV(VERIFIER_CGROUP_NOT_FOUND, cGroupIdentifier);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Register the Custom Applier Callback with Resource Tuner</span></div>
<div class="line">URM_REGISTER_RES_APPLIER_CB(0x00090005, limitCpuTime);</div>
<div class="ttc" id="aclassResource_html"><div class="ttname"><a href="classResource.html">Resource</a></div><div class="ttdoc">Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...</div><div class="ttdef"><b>Definition</b> <a href="Resource_8h_source.html#l00017">Resource.h:17</a></div></div>
<div class="ttc" id="aclassResource_html_a8d0f13af3594238d22d241aa83cbc1d5"><div class="ttname"><a href="classResource.html#a8d0f13af3594238d22d241aa83cbc1d5">Resource::mResValue</a></div><div class="ttdeci">union Resource::@0 mResValue</div><div class="ttdoc">The value to be Configured for this Resource Node.</div></div>
<div class="ttc" id="aclassResource_html_adf8c1d9a41a75b6bca752c6d85eba98b"><div class="ttname"><a href="classResource.html#adf8c1d9a41a75b6bca752c6d85eba98b">Resource::values</a></div><div class="ttdeci">int32_t values[2]</div><div class="ttdoc">Use this field for storing upto 2 Values.</div><div class="ttdef"><b>Definition</b> <a href="Resource_8h_source.html#l00042">Resource.h:42</a></div></div>
<div class="ttc" id="astructCGroupConfigInfo_html"><div class="ttname"><a href="structCGroupConfigInfo.html">CGroupConfigInfo</a></div><div class="ttdoc">Representation of a single CGroup Configuration Info.</div><div class="ttdef"><b>Definition</b> <a href="TargetRegistry_8h_source.html#l00037">TargetRegistry.h:37</a></div></div>
<div class="ttc" id="astructCGroupConfigInfo_html_aea13059e491061d0d2d09862f7fef189"><div class="ttname"><a href="structCGroupConfigInfo.html#aea13059e491061d0d2d09862f7fef189">CGroupConfigInfo::mCgroupName</a></div><div class="ttdeci">std::string mCgroupName</div><div class="ttdoc">Cgroup Name.</div><div class="ttdef"><b>Definition</b> <a href="TargetRegistry_8h_source.html#l00038">TargetRegistry.h:38</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md82"></a>
3. Custom Configs</h1>
<p><a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Tuner allows users to provide their own Config files for different entities like: Resources, Signals, Properties etc. In order for these custom config files to be read and parsed they can either be placed in /etc/urm/custom/ or if the user wants even more flexibility in terms of location, they can specify the location of the Config file, using the Extensions Interface's URM_REGISTER_CONFIG macro.</p>
<p>For example:</p>
<div class="fragment"><div class="line">URM_REGISTER_CONFIG(RESOURCE_CONFIG, <span class="stringliteral">&quot;/opt/custom/ResourcesConfig.yaml&quot;</span>)</div>
</div><!-- fragment --><p>This will tell <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Tuner that the custom Resources Config file is located at: "/opt/custom/ResourcesConfig.yaml". Similar strategy can be followed for Signals, Properties, Ext Features etc.</p>
<hr  />
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Jan 29 2026 05:48:40 for Userspace Resource Manager by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
