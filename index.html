<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Userspace Resource Manager: Userspace Resource Manager: A System Resource Tuning Framework</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Userspace Resource Manager
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Userspace <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Manager: A System <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Tuning Framework </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_docs_2README"></a> </p>
<h1><a class="anchor" id="autotoc_md1"></a>
Table of Contents</h1>
<ul>
<li>1. Overview<ul>
<li>1.1. Why uRM is Needed</li>
<li>1.2. Powerful System-Level Control</li>
<li>1.3. Dynamic Resource Provisioning via Signals</li>
<li>1.4. Extension Framework</li>
</ul>
</li>
<li>2. Getting Started</li>
<li>3. Configurable Resources and Signals<ul>
<li>3.1. Resources</li>
<li>3.2. Signals</li>
</ul>
</li>
<li>4. uRM Interface<ul>
<li>4.1. Platform Abstraction Layer</li>
<li>4.2. uRM APIs<ul>
<li>4.2.1. tuneResources<ul>
<li>4.2.1.1. SysResource</li>
<li>4.2.1.2. Resource ResCode Construction</li>
<li>4.2.1.3. Resource ResInfo Construction</li>
<li>4.2.1.4. Example</li>
</ul>
</li>
<li>4.2.2. retuneResources<ul>
<li>4.2.2.1. Example</li>
</ul>
</li>
<li>4.2.3. untuneResources<ul>
<li>4.2.3.1. Example</li>
</ul>
</li>
<li>4.2.4. tuneSignal<ul>
<li>4.2.4.1. Signal Code Construction</li>
</ul>
</li>
<li>4.2.5. untuneSignal</li>
<li>4.2.6. relaySignal</li>
<li>4.2.7. getProp</li>
</ul>
</li>
<li>4.3. Configs<ul>
<li>4.3.1. Initialization Configs</li>
<li>4.3.2. Resource Configs</li>
<li>4.3.3. Properties Config</li>
<li>4.3.4. Signal Configs</li>
<li>4.3.5. Per-App Configs</li>
</ul>
</li>
</ul>
</li>
<li>5. Client CLI<ul>
<li>5.1. Send a Tune Request</li>
<li>5.2. Send an Untune Request</li>
<li>5.3. Send a Retune Request</li>
<li>5.4. Send a getProp Request</li>
<li>5.5. Send a tuneSignal Request</li>
</ul>
</li>
<li>6. Customizations &amp; Extensions<ul>
<li>6.1. Extensions Interface<ul>
<li>6.1.1. Registering Resource Callbacks</li>
<li>6.1.2. Registering Custom Configs</li>
</ul>
</li>
<li>6.2. Custom Configs<ul>
<li>6.2.1. Initialization Configs</li>
<li>6.2.2. Resource Configs</li>
<li>6.2.3. Properties Config</li>
<li>6.2.4. Signal Configs</li>
<li>6.2.5. Target Configs</li>
</ul>
</li>
<li>6.3. Extension Features</li>
</ul>
</li>
<li>7. URM Implementation Details<ul>
<li>7.1. Project Structure</li>
<li>7.2. Userspace Resource Manager Key Points<ul>
<li>7.2.1. Contextual Classifier</li>
<li>7.2.2. Resource Tuner</li>
<li>7.2.3. URM Initialization</li>
<li>7.2.4. Request Processing</li>
</ul>
</li>
<li>7.3. Client-Level Permissions</li>
<li>7.4. Resource-Level Policies</li>
<li>7.5. Request-Level Priorities</li>
<li>7.6. Pulse Monitor</li>
<li>7.7. Rate Limiter</li>
<li>7.8. Duplicate Checking</li>
<li>7.9. Dynamic Mapper</li>
<li>7.10. Display-Aware Operational Modes</li>
<li>7.11. Crash Recovery</li>
<li>7.12. Flexible Packaging</li>
<li>7.13. Pre-Allocate Capacity for efficiency</li>
</ul>
</li>
<li>8. Contact</li>
<li>9. License</li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
1. Overview</h1>
<p>The Userspace <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Manager (uRM) is a lightweight, extensible framework designed to intelligently manage and provision system resources from userspace. It brings together two key components that enable dynamic, context‑aware optimization of performance and power across diverse embedded and resource‑constrained environments:</p><ul>
<li>Contextual Classifier A FastText‑based classifier that identifies static workload contexts—such as camera pipelines, multimedia sessions, installations, or background services. By understanding what the system is running, uRM can apply the right resource strategy without manual intervention.</li>
<li><a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Tuner A userspace engine that dynamically provisions system resources—CPU, memory, GPU, I/O, caches, and more—using standard kernel interfaces such as procfs, sysfs, and cgroups. This enables fine‑grained control of system operating points to balance performance and power for each application or use case. <div class="fragment"><div class="line">+---------------------------+</div>
<div class="line">| Process Event Listener    |</div>
<div class="line">|       (NetLinkComm)       |</div>
<div class="line">+-------------+-------------+</div>
<div class="line">              |                (Event trigger)</div>
<div class="line">              |             (from app using APIs)</div>
<div class="line">              V                      |</div>
<div class="line">+---------------------------+        |</div>
<div class="line">|    Contextual Classifier  |        |</div>
<div class="line">+-------------+-------------+        |</div>
<div class="line">              |                      |</div>
<div class="line">          (Workload)                 |</div>
<div class="line">              |                      |</div>
<div class="line">              V                      |</div>
<div class="line">+---------------------------+        |</div>
<div class="line">|     Resource Tuner        |&lt;-------+</div>
<div class="line">+-------------+-------------+</div>
<div class="line">              |</div>
<div class="line">              V</div>
<div class="line">      +--------------+</div>
<div class="line">      |    Action    |</div>
<div class="line">      +--------------+</div>
</div><!-- fragment --> </li>
</ul>
<h3><a class="anchor" id="autotoc_md3"></a>
1.1. Why uRM is Needed</h3>
<p>Modern workloads vary drastically across segments like servers, compute, XR, mobile, and IoT. Each use case exhibits unique characteristics. Some may demand high CPU frequency, others may require sustained GPU throughput, and many hinge on efficient caching or more memory bandwidth.</p>
<p>At the same time, these workloads run on a broad spectrum of hardware platforms with different capabilities, power envelopes, and user expectations. A "one‑size‑fits‑all" tuning approach fails in such environments.</p>
<p>uRM addresses this challenge by offering:</p><ul>
<li>Per‑use‑case adaptability</li>
<li>Hardware‑aware tuning</li>
<li>User‑experience‑driven power/perf balancing</li>
</ul>
<p>This allows systems to achieve consistent performance while minimizing energy consumption.</p>
<h3><a class="anchor" id="autotoc_md4"></a>
1.2. Powerful System‑Level Control</h3>
<p>Fine‑tuning system resources is a powerful tool for any developer or OEM building high‑performance embedded systems. With uRM, developers can directly influence operating points to match workload demands. For example: to boost performance, increase the CPU DCVS minimum frequency to 1 GHz to improve responsiveness during compute‑intensive scenarios. To save power, cap the maximum CPU frequency at 1.5 GHz when the workload is light, preventing unnecessary turbo boosts and improving battery life. Such targeted interventions can significantly enhance user experience while optimizing for energy efficiency.</p>
<h3><a class="anchor" id="autotoc_md5"></a>
1.3. Dynamic Resource Provisioning via Signals</h3>
<p>uRM introduces Signals, a mechanism that adjusts system resources in real time based on events such as:</p>
<ul>
<li>App launches</li>
<li>App installations</li>
<li>On‑device workflows or triggers</li>
</ul>
<p>These behaviors are governed by flexible, human‑readable YAML configurations, making policies easy to author, review, and evolve.</p>
<h3><a class="anchor" id="autotoc_md6"></a>
1.4. Extension Framework</h3>
<p>uRM also provides extension APIs that allow other modules or applications to:</p>
<ul>
<li>Register custom resources</li>
<li>Define custom provisioning logic</li>
<li>Add Segment‑specific or product‑specific behaviors</li>
</ul>
<p>This ensures the framework remains adaptable as hardware, use cases, and business requirements evolve.</p>
<div style="page-break-after: always;"></div><h1><a class="anchor" id="autotoc_md7"></a>
2. Getting Started</h1>
<p>To get started with the project: <a href="../README.md#build-and-install-instructions">Build and install</a></p>
<h1><a class="anchor" id="autotoc_md8"></a>
3. Configurable Resources and Signals</h1>
<h2><a class="anchor" id="autotoc_md9"></a>
3.1. Resources</h2>
<p><b><a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Code</b> is composed of two least significant bytes (the lower 16 bits) contains resource ID and next significant byte contains resource type i.e. 0xrr tt iiii (i: resource id, t: resource type, r: reserved)</p>
<p>The following resource codes are supported resources or operations on upstream Linux. Target or segment specific resources can be defined further. These resources can be directly used in client-side code or yaml configs and provide an easy and standard way to specify a certain resource, without needing to formulate the opcodes.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Name   </th><th class="markdownTableHeadNone">Id    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_CPU_DMA_LATENCY   </td><td class="markdownTableBodyNone">0x 00 01 0000    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_PM_QOS_LATENCY   </td><td class="markdownTableBodyNone">0x 00 01 0001    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_SCHED_UTIL_CLAMP_MIN   </td><td class="markdownTableBodyNone">0x 00 03 0000    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_SCHED_UTIL_CLAMP_MAX   </td><td class="markdownTableBodyNone">0x 00 03 0001    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_SCHED_ENERGY_AWARE   </td><td class="markdownTableBodyNone">0x 00 03 0002    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_SCALE_MIN_FREQ   </td><td class="markdownTableBodyNone">0x 00 04 0000    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_SCALE_MAX_FREQ   </td><td class="markdownTableBodyNone">0x 00 04 0001    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_RATE_LIMIT_US   </td><td class="markdownTableBodyNone">0x 00 04 0002    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_DEVFREQ_GPU_MAX   </td><td class="markdownTableBodyNone">0x 00 05 0000    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_DEVFREQ_GPU_MIN   </td><td class="markdownTableBodyNone">0x 00 05 0001    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_DEVFREQ_GPU_POLL_INTV   </td><td class="markdownTableBodyNone">0x 00 05 0002    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_CGRP_MOVE_PID   </td><td class="markdownTableBodyNone">0x 00 09 0000    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_CGRP_MOVE_TID   </td><td class="markdownTableBodyNone">0x 00 09 0001    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_CGRP_RUN_CORES   </td><td class="markdownTableBodyNone">0x 00 09 0002    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_CGRP_RUN_CORES_EXCL   </td><td class="markdownTableBodyNone">0x 00 09 0003    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_CGRP_FREEZE   </td><td class="markdownTableBodyNone">0x 00 09 0004    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_CGRP_LIMIT_CPU_TIME   </td><td class="markdownTableBodyNone">0x 00 09 0005    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_CGRP_RUN_WHEN_CPU_IDLE   </td><td class="markdownTableBodyNone">0x 00 09 0006    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_CGRP_UCLAMP_MIN   </td><td class="markdownTableBodyNone">0x 00 09 0007    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_CGRP_UCLAMP_MAX   </td><td class="markdownTableBodyNone">0x 00 09 0008    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_CGRP_REL_CPU_WEIGHT   </td><td class="markdownTableBodyNone">0x 00 09 0009    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_CGRP_HIGH_MEM   </td><td class="markdownTableBodyNone">0x 00 09 000a    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_CGRP_MAX_MEM   </td><td class="markdownTableBodyNone">0x 00 09 000b    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_CGRP_LOW_MEM   </td><td class="markdownTableBodyNone">0x 00 09 000c    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_CGRP_MIN_MEM   </td><td class="markdownTableBodyNone">0x 00 09 000d    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_CGRP_SWAP_MAX_MEMORY   </td><td class="markdownTableBodyNone">0x 00 09 000e    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_CGRP_IO_WEIGHT   </td><td class="markdownTableBodyNone">0x 00 09 000f    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_CGRP_BFQ_IO_WEIGHT   </td><td class="markdownTableBodyNone">0x 00 09 0010    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_CGRP_CPU_LATENCY   </td><td class="markdownTableBodyNone">0x 00 09 0011    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_DEVFREQ_UFS_MAX   </td><td class="markdownTableBodyNone">0x 00 0a 0000    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RES_DEVFREQ_UFS_MIN   </td><td class="markdownTableBodyNone">0x 00 0a 0001    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RES_DEVFREQ_UFS_POLL_INTV   </td><td class="markdownTableBodyNone">0x 00 0a 0002   </td></tr>
</table>
<p>The above mentioned list of enums are available in the interface file "UrmPlatformAL.h".</p>
<h2><a class="anchor" id="autotoc_md10"></a>
3.2. Signals</h2>
<p><b><a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> Code</b> is composed of two least significant bytes (the lower 16 bits) contains signal ID and next significant byte contains signal category i.e. 0xrr cc iiii (i: signal id, t: signal category, r: reserved)</p>
<p>The following signal codes are supported signals. Target or segment specific custom signals can be defined further.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> Code   </th><th class="markdownTableHeadNone">Code    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">URM_SIG_APP_OPEN   </td><td class="markdownTableBodyNone">0x 00 02 0001    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">URM_SIG_BROWSER_APP_OPEN   </td><td class="markdownTableBodyNone">0x 00 02 0002    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">URM_SIG_GAME_APP_OPEN   </td><td class="markdownTableBodyNone">0x 00 02 0003    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">URM_SIG_MULTIMEDIA_APP_OPEN   </td><td class="markdownTableBodyNone">0x 00 02 0004   </td></tr>
</table>
<p>The above mentioned list of enums are available in the interface file "UrmPlatformAL.h".</p>
<h1><a class="anchor" id="autotoc_md11"></a>
4. uRM Interface</h1>
<ul>
<li>Platform Abstraction Layer</li>
<li>uRM APIs</li>
<li>Configs</li>
</ul>
<h2><a class="anchor" id="autotoc_md12"></a>
4.1. Platform Abstraction Layer</h2>
<p>This section defines logical layer to improve code and config portability across different targets and segments.</p>
<p>Some logical maps are present in init config, these can not be changed.</p>
<p><b>Logical Cluster Map</b> Logical IDs for clusters. Configs of cluster map can be found in InitConfigs-&gt;ClusterMap section </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">LgcId   </th><th class="markdownTableHeadNone">Name    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">"little"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">"big"    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">"prime"   </td></tr>
</table>
<p><b>Cgroups map</b> Logical IDs for cgroups. Configs of cgroups map in InitConfigs-&gt;CgroupsInfo section</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Lgc Cgrp No   </th><th class="markdownTableHeadNone">Cgrp Name    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">"root"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">"init.scope"    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">"system.slice"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">"user.slice"    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">"focused.slice"   </td></tr>
</table>
<p><b>Mpam Groups Map</b> Logical IDs for MPAM groups. Configs of MPAM group map in InitConfigs-&gt;MpamGroupsInfo section </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">LgcId   </th><th class="markdownTableHeadNone">Mpam grp Name    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">"default"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">"video"    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">"camera"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">"games"   </td></tr>
</table>
<p><b><a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Types</b> These are defined in <a class="el" href="UrmPlatformAL_8h_source.html">UrmPlatformAL.h</a> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Type   </th><th class="markdownTableHeadNone">type   </th><th class="markdownTableHeadNone"><a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Type   </th><th class="markdownTableHeadNone">type    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Cpu Lpm   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">Memory Qos   </td><td class="markdownTableBodyNone">7    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Cache Mgmt   </td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">Mpam Qos   </td><td class="markdownTableBodyNone">8    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Cpu Sched   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">Cgroup Ops   </td><td class="markdownTableBodyNone">9    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Cpu Freq   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">Storage IO   </td><td class="markdownTableBodyNone">10    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Gpu Opp   </td><td class="markdownTableBodyNone">5   </td><td class="markdownTableBodyNone">Custom   </td><td class="markdownTableBodyNone">128+    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Npu   </td><td class="markdownTableBodyNone">6   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td></tr>
</table>
<p><b><a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> Categories</b> These are defined <a class="el" href="UrmPlatformAL_8h_source.html">UrmPlatformAL.h</a> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> Category   </th><th class="markdownTableHeadNone">Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">URM_SIG_CAT_TEST   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">URM_SIG_CAT_GENERIC   </td><td class="markdownTableBodyNone">2    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">URM_SIG_CAT_MULTIMEDIA   </td><td class="markdownTableBodyNone">3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">URM_SIG_CAT_GAMING   </td><td class="markdownTableBodyNone">4    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">URM_SIG_CAT_BROWSER   </td><td class="markdownTableBodyNone">5    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">URM_SIG_CAT_CUSTOM   </td><td class="markdownTableBodyNone">128+   </td></tr>
</table>
<p>Custom resource types and signal categories must be &gt;=128 to avoid conflicts with default types.</p>
<h2><a class="anchor" id="autotoc_md13"></a>
4.2. uRM APIs</h2>
<p>This API suite allows you to manage system resource provisioning through tuning requests. You can issue, modify, or withdraw resource tuning requests with specified durations and priorities.</p>
<p>APIs examples: <a href="https://github.com/qualcomm/userspace-resource-manager/tree/main/docs/Examples">https://github.com/qualcomm/userspace-resource-manager/tree/main/docs/Examples</a></p>
<h3><a class="anchor" id="autotoc_md14"></a>
4.2.1. tuneResources</h3>
<p><b>Description:</b> Issues a resource provisioning (or tuning) request for a finite or infinite duration.</p>
<p><b>API Signature:</b> </p><div class="fragment"><div class="line">int64_t <a class="code hl_function" href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga1eac546e5691c0c3d5d7036a68ba6a2b">tuneResources</a>(int64_t duration,</div>
<div class="line">                      int32_t prop,</div>
<div class="line">                      int32_t numRes,</div>
<div class="line">                      <a class="code hl_struct" href="structSysResource.html">SysResource</a>* resourceList);</div>
<div class="ttc" id="agroup__RESOURCE__TUNER__CLIENT__APIS_html_ga1eac546e5691c0c3d5d7036a68ba6a2b"><div class="ttname"><a href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga1eac546e5691c0c3d5d7036a68ba6a2b">tuneResources</a></div><div class="ttdeci">int64_t tuneResources(int64_t duration, int32_t prop, int32_t numRes, SysResource *resourceList)</div><div class="ttdoc">Tune Resource Values for finite or finite duration.</div></div>
<div class="ttc" id="astructSysResource_html"><div class="ttname"><a href="structSysResource.html">SysResource</a></div><div class="ttdoc">Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...</div><div class="ttdef"><b>Definition</b> <a href="UrmPlatformAL_8h_source.html#l00027">UrmPlatformAL.h:27</a></div></div>
</div><!-- fragment --><p><b>Parameters:</b></p>
<ul>
<li><code>duration</code> (<code>int64_t</code>): Duration in milliseconds for which the <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource(s)</a> should be Provisioned. Use <code>-1</code> for an infinite duration.</li>
<li><code>properties</code> (<code>int32_t</code>): Properties of the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a>.<ul>
<li>The last 8 bits [25 - 32] store the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a> Priority (HIGH / LOW)</li>
<li>The Next 8 bits [17 - 24] represent a Boolean Flag, which indicates if the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a> should be processed in the background (in case of Display Off or Doze Mode).</li>
</ul>
</li>
<li><code>numRes</code> (<code>int32_t</code>): Number of resources to be tuned as part of the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a>.</li>
<li><code>resourceList</code> (<code>SysResource*</code>): List of Resources to be provisioned as part of the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a>.</li>
</ul>
<p><b>Returns:</b> <code>int64_t</code></p><ul>
<li><b>A positive unique handle</b> identifying the issued request (used for future <code>retune</code> or <code>untune</code> operations)</li>
<li><code>-1</code> otherwise.</li>
</ul>
<h4><a class="anchor" id="autotoc_md15"></a>
4.2.1.1. SysResource</h4>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    uint32_t mResCode;</div>
<div class="line">    int32_t mResInfo;</div>
<div class="line">    int32_t mOptionalInfo;</div>
<div class="line">    int32_t mNumValues;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">union </span>{</div>
<div class="line">        int32_t value;</div>
<div class="line">        int32_t* values;</div>
<div class="line">    } mResValue;</div>
<div class="line">} <a class="code hl_struct" href="structSysResource.html">SysResource</a>;</div>
</div><!-- fragment --><p><code>mResCode</code> (<code>uint32_t</code>): An unsigned 32-bit unique identifier for the resource. It encodes essential information that is useful in abstracting away the system specific details.</p>
<p><code>mResInfo</code> (<code>int32_t</code>): Encodes operation-specific information such as the Logical cluster and Logical core ID, and MPAM part ID.</p>
<p><code>mOptionalInfo</code> (<code>int32_t</code>): Additional optional metadata, useful for custom or extended resource configurations.</p>
<p><code>mNumValues</code> (<code>int32_t</code>): Number of values associated with the resource. If multiple values are needed, this must be set accordingly.</p>
<p><code>Value / Values</code> (<code>uint32_t *</code>): It is a single value when the resource requires a single value or a pointer to an array of values for multi-value configurations.</p>
<h4><a class="anchor" id="autotoc_md16"></a>
4.2.1.2. Resource ResCode Construction</h4>
<p>This section describes how this code can be constructed. URM implements a platform abstraction layer (logical layer) which provides a transparent and consistent way for indexing resources. This makes it easy for the clients to identify the resource they want to provision, without needing to worry about portability issues across targets.</p>
<div class="fragment"><div class="line">Resource code (unsigned 32 bit) is composed of two fields:</div>
<div class="line">- ResID (LSBs 0-15)</div>
<div class="line">- ResType (next 8 bits, 16-23)</div>
<div class="line"> </div>
<div class="line">31                 24                 16                         0</div>
<div class="line">+--------------------+------------------+------------------------+</div>
<div class="line">| Reserved (1 byte)  | ResType (1 byte) |     ResId (2 bytes)    |</div>
<div class="line">+--------------------+------------------+------------------------+</div>
</div><!-- fragment --><p>These fields combined together can uniquely identify a resource across targets, hence making the code operating on these resources interchangable.</p>
<div class="fragment"><div class="line">Examples:</div>
<div class="line">Code for cpu_freq (0x04) resource type and min_freq (0x00) operation : 0x00040000</div>
<div class="line"> </div>
<div class="line">                     cpu_freq  min_freq</div>
<div class="line">0x00040000 - 0x00    04        00000</div>
<div class="line"> </div>
<div class="line">Code for cgrp (0x09) resource type and run-cores (0x02) operation : 0x00090002</div>
<div class="line"> </div>
<div class="line">                     cgrp      run-on-cores</div>
<div class="line">0x00090002 - 0x00    09        00002</div>
</div><!-- fragment --><p>The macro <b>CONSTRUCT_RES_CODE</b> can be used for generating opcodes directly from the resource type and resource id: </p><div class="fragment"><div class="line">uint32_t resCode = CONSTRUCT_RES_CODE(0x09, 0x02);</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md17"></a>
4.2.1.3. Resource ResInfo Construction</h4>
<p>The ResInfo field specified as part of the <a class="el" href="structSysResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">SysResource</a> struct encodes the following information:</p>
<div class="fragment"><div class="line">- Bits [0 - 7]: Core Information</div>
<div class="line">- Bits [8 - 15]: Cluster Information</div>
<div class="line">- Bits [16 - 31]: MPAM Application Information</div>
<div class="line"> </div>
<div class="line">31          24            16            8             0</div>
<div class="line">+-------------+-------------+------------+------------+</div>
<div class="line">|      MPAM Info            |  Cluster   |     Core   |</div>
<div class="line">+-------------+-------------+------------+------------+</div>
</div><!-- fragment --><div class="fragment"><div class="line">Examples:</div>
<div class="line">ResInfo for if you want operate resource on big cluster(0x01) : 0x00000100</div>
<div class="line"> </div>
<div class="line">                       cluster   core</div>
<div class="line">0x00040000 - 0x0000    01        00</div>
</div><!-- fragment --><p>The macros SET_RESOURCE_CLUSTER_VALUE and SET_RESOURCE_CORE_VALUE are provided for clients to easily specify the configuration core / cluster information, if needed.</p>
<div class="fragment"><div class="line">int32_t mResInfo = 0;</div>
<div class="line"><span class="comment">// Set logical cluster ID to 1 (Gold)</span></div>
<div class="line">mResInfo = SET_RESOURCE_CLUSTER_VALUE(mResInfo, 1);</div>
</div><!-- fragment --><div class="fragment"><div class="line">int32_t mResInfo = 0;</div>
<div class="line"><span class="comment">// 2nd core on the little cluster</span></div>
<div class="line">mResInfo = SET_RESOURCE_CLUSTER_VALUE(mResInfo, 0);</div>
<div class="line">mResInfo = SET_RESOURCE_CORE_VALUE(mResInfo, 2)</div>
</div><!-- fragment --><p> <b><a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> mOptionalInfo</b> The mOptionalInfo field, as the name suggests can be used to store any optional information needed for resource application. It can be used as part of customized resource applier / tear callbacks if needed, else it can be left as 0.</p>
<p><b><a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> mNumValues and value(s)</b> URM Allows for both single and multi-valued configurations. The <a class="el" href="structSysResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">SysResource</a> struct allows for storing all the configuration values. The field mNumValues specifies the number of values to be configured</p>
<p>The following example shows a simple single-valued config, use the "value" field in the mResValue union.</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structSysResource.html">SysResource</a> resourceList[1];</div>
<div class="line">memset(&amp;resourceList[0], 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structSysResource.html">SysResource</a>));</div>
<div class="line">resourceList[0].<a class="code hl_variable" href="structSysResource.html#a547486b7dc00085ba938e3234526706d">mResCode</a> = 0x0002a0be;</div>
<div class="line">resourceList[0].<a class="code hl_variable" href="structSysResource.html#aa7ed699e963bd7e4ae9072a60f52127a">mResInfo</a> = SET_RESOURCE_CLUSTER_VALUE(resourceList[0].mResInfo, 1);</div>
<div class="line">resourceList[0].<a class="code hl_variable" href="structSysResource.html#a8e1edb5ff3e4c91904666d79d5bc06c7">mNumValues</a> = 1;</div>
<div class="line">resourceList[0].<a class="code hl_variable" href="structSysResource.html#aca188a66ddf08b265bcf2026fa7632ee">mResValue</a>.<a class="code hl_variable" href="structSysResource.html#a41dca28f9f5b0fdf0a4ba53945ad8de5">value</a> = 999;</div>
<div class="ttc" id="astructSysResource_html_a41dca28f9f5b0fdf0a4ba53945ad8de5"><div class="ttname"><a href="structSysResource.html#a41dca28f9f5b0fdf0a4ba53945ad8de5">SysResource::value</a></div><div class="ttdeci">int32_t value</div><div class="ttdoc">Use this field for single Valued Resources.</div><div class="ttdef"><b>Definition</b> <a href="UrmPlatformAL_8h_source.html#l00049">UrmPlatformAL.h:49</a></div></div>
<div class="ttc" id="astructSysResource_html_a547486b7dc00085ba938e3234526706d"><div class="ttname"><a href="structSysResource.html#a547486b7dc00085ba938e3234526706d">SysResource::mResCode</a></div><div class="ttdeci">uint32_t mResCode</div><div class="ttdoc">A uniqued 32-bit (unsigned) identifier for the Resource.</div><div class="ttdef"><b>Definition</b> <a href="UrmPlatformAL_8h_source.html#l00034">UrmPlatformAL.h:34</a></div></div>
<div class="ttc" id="astructSysResource_html_a8e1edb5ff3e4c91904666d79d5bc06c7"><div class="ttname"><a href="structSysResource.html#a8e1edb5ff3e4c91904666d79d5bc06c7">SysResource::mNumValues</a></div><div class="ttdeci">int32_t mNumValues</div><div class="ttdoc">Number of values to be configured for the Resource, both single-valued and multi-valued Resources are...</div><div class="ttdef"><b>Definition</b> <a href="UrmPlatformAL_8h_source.html#l00046">UrmPlatformAL.h:46</a></div></div>
<div class="ttc" id="astructSysResource_html_aa7ed699e963bd7e4ae9072a60f52127a"><div class="ttname"><a href="structSysResource.html#aa7ed699e963bd7e4ae9072a60f52127a">SysResource::mResInfo</a></div><div class="ttdeci">int32_t mResInfo</div><div class="ttdoc">Holds Logical Core and Cluster Information:</div><div class="ttdef"><b>Definition</b> <a href="UrmPlatformAL_8h_source.html#l00040">UrmPlatformAL.h:40</a></div></div>
<div class="ttc" id="astructSysResource_html_aca188a66ddf08b265bcf2026fa7632ee"><div class="ttname"><a href="structSysResource.html#aca188a66ddf08b265bcf2026fa7632ee">SysResource::mResValue</a></div><div class="ttdeci">union SysResource::@4 mResValue</div><div class="ttdoc">The value to be Configured for this Resource Node.</div></div>
</div><!-- fragment --><p>If multi-valued config is needed, the use the "values" field in the mResValue union.</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structSysResource.html">SysResource</a>* resourceList = <span class="keyword">new</span> <a class="code hl_struct" href="structSysResource.html">SysResource</a>[1];</div>
<div class="line">memset(&amp;resourceList[0], 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structSysResource.html">SysResource</a>));</div>
<div class="line"> </div>
<div class="line">resourceList[0].<a class="code hl_variable" href="structSysResource.html#a547486b7dc00085ba938e3234526706d">mResCode</a> = 0x00090007;</div>
<div class="line">resourceList[0].<a class="code hl_variable" href="structSysResource.html#aa7ed699e963bd7e4ae9072a60f52127a">mResInfo</a> = 0;</div>
<div class="line">resourceList[0].<a class="code hl_variable" href="structSysResource.html#a8e1edb5ff3e4c91904666d79d5bc06c7">mNumValues</a> = 2;</div>
<div class="line">resourceList[0].<a class="code hl_variable" href="structSysResource.html#aca188a66ddf08b265bcf2026fa7632ee">mResValue</a>.<a class="code hl_variable" href="structSysResource.html#ae14a01147839611697dd6086d41b0917">values</a> = <span class="keyword">new</span> int32_t[resourceList[0].<a class="code hl_variable" href="structSysResource.html#a8e1edb5ff3e4c91904666d79d5bc06c7">mNumValues</a>];</div>
<div class="line">resourceList[0].mResValue.values[0] = 0;</div>
<div class="line">resourceList[0].mResValue.values[1] = 55;</div>
<div class="ttc" id="astructSysResource_html_ae14a01147839611697dd6086d41b0917"><div class="ttname"><a href="structSysResource.html#ae14a01147839611697dd6086d41b0917">SysResource::values</a></div><div class="ttdeci">int32_t * values</div><div class="ttdoc">Use this field for Multi Valued Resources.</div><div class="ttdef"><b>Definition</b> <a href="UrmPlatformAL_8h_source.html#l00050">UrmPlatformAL.h:50</a></div></div>
</div><!-- fragment --><p> The caller is responsible for freeing <a class="el" href="structSysResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">SysResource</a> objects and any allocated value arrays.</p>
<h4><a class="anchor" id="autotoc_md18"></a>
4.2.1.4. Example</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;Urm/UrmAPIs.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> sendRequest() {</div>
<div class="line">    <span class="comment">// Define resources</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Need to tune a single resource</span></div>
<div class="line">    <a class="code hl_struct" href="structSysResource.html">SysResource</a>* resourceList = <span class="keyword">new</span> <a class="code hl_struct" href="structSysResource.html">SysResource</a>[2];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//Seting cpu min_freq of big cluster</span></div>
<div class="line">    resourceList[0].<a class="code hl_variable" href="structSysResource.html#a547486b7dc00085ba938e3234526706d">mResCode</a> = 0x00040000;</div>
<div class="line">    resourceList[0].<a class="code hl_variable" href="structSysResource.html#aa7ed699e963bd7e4ae9072a60f52127a">mResInfo</a> = SET_RESOURCE_CLUSTER_VALUE(resourceList[0].mResInfo, 1);</div>
<div class="line">    resourceList[0].<a class="code hl_variable" href="structSysResource.html#a8e1edb5ff3e4c91904666d79d5bc06c7">mNumValues</a> = 1;</div>
<div class="line">    resourceList[0].<a class="code hl_variable" href="structSysResource.html#aca188a66ddf08b265bcf2026fa7632ee">mResValue</a>.<a class="code hl_variable" href="structSysResource.html#a41dca28f9f5b0fdf0a4ba53945ad8de5">value</a> = 980;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Resource Identifier, capping cpu max_freq of prime cluster</span></div>
<div class="line">    resourceList[1].<a class="code hl_variable" href="structSysResource.html#a547486b7dc00085ba938e3234526706d">mResCode</a> = 0x00040001;</div>
<div class="line">    resourceList[1].<a class="code hl_variable" href="structSysResource.html#aa7ed699e963bd7e4ae9072a60f52127a">mResInfo</a> = SET_RESOURCE_CLUSTER_VALUE(resourceList[1].mResInfo, 2);</div>
<div class="line">    resourceList[1].<a class="code hl_variable" href="structSysResource.html#a8e1edb5ff3e4c91904666d79d5bc06c7">mNumValues</a> = 1;</div>
<div class="line">    resourceList[1].<a class="code hl_variable" href="structSysResource.html#aca188a66ddf08b265bcf2026fa7632ee">mResValue</a>.<a class="code hl_variable" href="structSysResource.html#a41dca28f9f5b0fdf0a4ba53945ad8de5">value</a> = 1024;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Issue the Tune Request</span></div>
<div class="line">    int64_t handle = <a class="code hl_function" href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga1eac546e5691c0c3d5d7036a68ba6a2b">tuneResources</a>(5000, 0, 2, resourceList);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span>(handle &lt; 0) {</div>
<div class="line">        std::cerr&lt;&lt;<span class="stringliteral">&quot;Failed to issue tuning request.&quot;</span>&lt;&lt;std::endl;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        std::cout&lt;&lt;<span class="stringliteral">&quot;Tuning request issued. Handle: &quot;</span>&lt;&lt;handle&lt;&lt;std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (resourceList) {</div>
<div class="line">        <span class="keyword">delete</span> resourceList;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> The memory allocated for the resourceList needs to be freed by the caller.</p>
<h3><a class="anchor" id="autotoc_md19"></a>
4.2.2. retuneResources</h3>
<p><b>Description:</b> Modifies the duration of an existing tune request.</p>
<p><b>API Signature:</b> </p><div class="fragment"><div class="line">int8_t <a class="code hl_function" href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga3e60de0521a903c940e47f2c0a1ced5a">retuneResources</a>(int64_t handle,</div>
<div class="line">                       int64_t duration);</div>
<div class="ttc" id="agroup__RESOURCE__TUNER__CLIENT__APIS_html_ga3e60de0521a903c940e47f2c0a1ced5a"><div class="ttname"><a href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga3e60de0521a903c940e47f2c0a1ced5a">retuneResources</a></div><div class="ttdeci">int8_t retuneResources(int64_t handle, int64_t duration)</div><div class="ttdoc">Modify the duration of a previously issued Tune Request.</div></div>
</div><!-- fragment --><p><b>Parameters:</b></p>
<ul>
<li><code>handle</code> (<code>int64_t</code>): Handle of the original request, returned by the call to <code>tuneResources</code>.</li>
<li><code>duration</code> (<code>int64_t</code>): New duration in milliseconds. Use <code>-1</code> for an infinite duration.</li>
</ul>
<p><b>Returns:</b> <code>int8_t</code></p><ul>
<li><code>0</code> if the request was successfully submitted.</li>
<li><code>-1</code> otherwise.</li>
</ul>
<h4><a class="anchor" id="autotoc_md20"></a>
4.2.2.1. Example</h4>
<p>The below example demonstrates the use of the retuneResources API for modifying a request's duration. Note: Only extension of request duration is allowed.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> sendRequest() {</div>
<div class="line">    <span class="comment">// Modify the duration of a previously issued Tune Request to 20 seconds</span></div>
<div class="line">    <span class="comment">// Let&#39;s say we stored the handle returned by the tuneResources API in</span></div>
<div class="line">    <span class="comment">// a variable called &quot;handle&quot;. Then the retuneResources API can be simply called like:</span></div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code hl_function" href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga3e60de0521a903c940e47f2c0a1ced5a">retuneResources</a>(handle, 20000) &lt; 0) {</div>
<div class="line">        std::cerr&lt;&lt;<span class="stringliteral">&quot;Failed to Send retune request to URM Server&quot;</span>&lt;&lt;std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md21"></a>
4.2.3. untuneResources</h3>
<p><b>Description:</b> Withdraws a previously issued resource provisioning (or tune) request.</p>
<p><b>API Signature:</b> </p><div class="fragment"><div class="line">int8_t <a class="code hl_function" href="group__RESOURCE__TUNER__CLIENT__APIS.html#gac2fd2c0cfa92a0573ff1e3d190072ad2">untuneResources</a>(int64_t handle);</div>
<div class="ttc" id="agroup__RESOURCE__TUNER__CLIENT__APIS_html_gac2fd2c0cfa92a0573ff1e3d190072ad2"><div class="ttname"><a href="group__RESOURCE__TUNER__CLIENT__APIS.html#gac2fd2c0cfa92a0573ff1e3d190072ad2">untuneResources</a></div><div class="ttdeci">int8_t untuneResources(int64_t handle)</div><div class="ttdoc">Release (or free) the Request with the given handle.</div></div>
</div><!-- fragment --><p><b>Parameters:</b></p>
<ul>
<li><code>handle</code> (<code>int64_t</code>): Handle of the original request, returned by the call to <code>tuneResources</code>.</li>
</ul>
<p><b>Returns:</b> <code>int8_t</code></p><ul>
<li><code>0</code> if the request was successfully submitted.</li>
<li><code>-1</code> otherwise.</li>
</ul>
<h4><a class="anchor" id="autotoc_md22"></a>
4.2.3.1. Example</h4>
<p>The below example demonstrates the use of the untuneResources API for untuning (i.e. reverting) a previously issued tune <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a>.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> sendRequest() {</div>
<div class="line">    <span class="comment">// Withdraw a Previously issued tuning request</span></div>
<div class="line">    <span class="keywordflow">if</span>(<a class="code hl_function" href="group__RESOURCE__TUNER__CLIENT__APIS.html#gac2fd2c0cfa92a0573ff1e3d190072ad2">untuneResources</a>(handle) &lt; 0) {</div>
<div class="line">        std::cerr&lt;&lt;<span class="stringliteral">&quot;Failed to Send untune request to URM Server&quot;</span>&lt;&lt;std::endl;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md23"></a>
4.2.4. tuneSignal</h3>
<p><b>Description:</b> Tune the signal with the given ID.</p>
<p><b>API Signature:</b> </p><div class="fragment"><div class="line">int64_t <a class="code hl_function" href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga3c652f0874217ba2df98289c8c556311">tuneSignal</a>(uint32_t sigId,</div>
<div class="line">                   uint32_t sigType,</div>
<div class="line">                   int64_t duration,</div>
<div class="line">                   int32_t properties,</div>
<div class="line">                   <span class="keyword">const</span> <span class="keywordtype">char</span>* appName,</div>
<div class="line">                   <span class="keyword">const</span> <span class="keywordtype">char</span>* scenario,</div>
<div class="line">                   int32_t numArgs,</div>
<div class="line">                   uint32_t* list);</div>
<div class="ttc" id="agroup__RESOURCE__TUNER__CLIENT__APIS_html_ga3c652f0874217ba2df98289c8c556311"><div class="ttname"><a href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga3c652f0874217ba2df98289c8c556311">tuneSignal</a></div><div class="ttdeci">int64_t tuneSignal(uint32_t sigId, uint32_t sigType, int64_t duration, int32_t properties, const char *appName, const char *scenario, int32_t numArgs, uint32_t *list)</div><div class="ttdoc">Tune the signal with the given ID.</div></div>
</div><!-- fragment --><p><b>Parameters:</b></p>
<ul>
<li><code>sigID</code> (<code>uint32_t</code>): A uniqued 32-bit (unsigned) identifier for the <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a><ul>
<li>The last 16 bits (17-32) are used to specify the SigID</li>
<li>The next 8 bits (9-16) are used to specify the <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> Category</li>
<li>In addition for Custom Signals, the MSB must be set to 1 as well</li>
</ul>
</li>
<li><code>sigType</code> (<code>uint32_t</code>): Type of the signal, sigType is typically used in multimedia pipelines (camera, encoder, transcoder) where the same signal ID may represent multiple mode variants. Default value is 0.</li>
<li><code>duration</code> (<code>int64_t</code>): Duration (in milliseconds) to tune the <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> for. A value of -1 denotes infinite duration.</li>
<li><code>properties</code> (<code>int32_t</code>): Properties of the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a>.<ul>
<li>The last 8 bits [25 - 32] store the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a> Priority (HIGH / LOW)</li>
<li>The Next 8 bits [17 - 24] represent a Boolean Flag, which indicates if the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a> should be processed in the background (in case of Display Off or Doze Mode).</li>
</ul>
</li>
<li><code>appName</code> (<code>const char*</code>): Name of the Application that is issuing the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a></li>
<li><code>scenario</code> (<code>const char*</code>): Use-Case Scenario</li>
<li><code>numArgs</code> (<code>int32_t</code>): Number of Additional Arguments to be passed as part of the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a></li>
<li><code>list</code> (<code>uint32_t*</code>): List of Additional Arguments to be passed as part of the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a></li>
</ul>
<p><b>Returns:</b> <code>int64_t</code></p><ul>
<li>A Positive Unique Handle to identify the issued <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a>. The handle is used for freeing the Provisioned signal later.</li>
<li><code>-1</code>: If the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a> could not be sent to the server.</li>
</ul>
<h4><a class="anchor" id="autotoc_md24"></a>
4.2.4.1. Signal Code Construction</h4>
<div class="fragment"><div class="line">Signals are identified (similar to Resources) via an unsigned 32-bit integer.</div>
<div class="line">- SigID (LSBs 0-15)</div>
<div class="line">- Sig Category (next 8 bits, 16-23)</div>
<div class="line"> </div>
<div class="line">31                 24                 16                         0</div>
<div class="line">+--------------------+------------------+------------------------+</div>
<div class="line">| Reserved (1 byte)  | Sig Cat (1 byte) |     SigId (2 bytes)    |</div>
<div class="line">+--------------------+------------------+------------------------+</div>
</div><!-- fragment --><p>The macro "CONSTRUCT_SIG_CODE" can be used for generating opcodes directly if the ResType and ResID are known: </p><div class="fragment"><div class="line">uint32_t sigCode = CONSTRUCT_SIG_CODE(0x0d, 0x0008);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md25"></a>
4.2.5. untuneSignal</h3>
<p><b>Description:</b> Release (or free) the signal with the given handle.</p>
<p><b>API Signature:</b> </p><div class="fragment"><div class="line">int8_t <a class="code hl_function" href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga187247166948c0ec04988207a8a37e1c">untuneSignal</a>(int64_t handle);</div>
<div class="ttc" id="agroup__RESOURCE__TUNER__CLIENT__APIS_html_ga187247166948c0ec04988207a8a37e1c"><div class="ttname"><a href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga187247166948c0ec04988207a8a37e1c">untuneSignal</a></div><div class="ttdeci">int8_t untuneSignal(int64_t handle)</div><div class="ttdoc">Release (or free) the signal with the given handle.</div></div>
</div><!-- fragment --><p><b>Parameters:</b></p>
<ul>
<li><code>handle</code> (<code>int64_t</code>): <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a> Handle, returned by the tuneSignal API call.</li>
</ul>
<p><b>Returns:</b> <code>int8_t</code></p><ul>
<li><code>0</code>: If the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a> was successfully sent to the server.</li>
<li><code>-1</code>: Otherwise</li>
</ul>
<hr  />
 <div style="page-break-after: always;"></div><h3><a class="anchor" id="autotoc_md27"></a>
4.2.6. relaySignal</h3>
<p><b>Description:</b> Tune the signal with the given ID.</p>
<p><b>API Signature:</b> </p><div class="fragment"><div class="line">int8_t <a class="code hl_function" href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga5a4249a35267efc5c291069ca1a028e1">relaySignal</a>(uint32_t sigId,</div>
<div class="line">                   uint32_t sigType,</div>
<div class="line">                   int64_t duration,</div>
<div class="line">                   int32_t properties,</div>
<div class="line">                   <span class="keyword">const</span> <span class="keywordtype">char</span>* appName,</div>
<div class="line">                   <span class="keyword">const</span> <span class="keywordtype">char</span>* scenario,</div>
<div class="line">                   int32_t numArgs,</div>
<div class="line">                   uint32_t* list);</div>
<div class="ttc" id="agroup__RESOURCE__TUNER__CLIENT__APIS_html_ga5a4249a35267efc5c291069ca1a028e1"><div class="ttname"><a href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga5a4249a35267efc5c291069ca1a028e1">relaySignal</a></div><div class="ttdeci">int8_t relaySignal(uint32_t sigId, uint32_t sigType, int64_t duration, int32_t properties, const char *appName, const char *scenario, int32_t numArgs, uint32_t *list)</div><div class="ttdoc">Relay the signal to all the features subscribed to the signal with the given ID.</div></div>
</div><!-- fragment --><p><b>Parameters:</b></p>
<ul>
<li><code>sigId</code> (<code>uint32_t</code>): A uniqued 32-bit (unsigned) identifier for the <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a><ul>
<li>The last 16 bits (17-32) are used to specify the SigID</li>
<li>The next 8 bits (9-16) are used to specify the <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> Category</li>
<li>In addition for Custom Signals, the MSB must be set to 1 as well</li>
</ul>
</li>
<li><code>sigType</code> (<code>uint32_t</code>): Type of the signal, useful for use-case based signal filtering and selection, i.e. in situations where multiple variants of the same core signal (with minor changes) need to exist to support different use-case scenarios. If no such filtering is needed, pass this field as 0.</li>
<li><code>duration</code> (<code>int64_t</code>): Duration (in milliseconds)</li>
<li><code>properties</code> (<code>int32_t</code>): Properties of the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a>.<ul>
<li>The last 8 bits [25 - 32] store the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a> Priority (HIGH / LOW)</li>
<li>The Next 8 bits [17 - 24] represent a Boolean Flag, which indicates if the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a> should be processed in the background (in case of Display Off or Doze Mode).</li>
</ul>
</li>
<li><code>appName</code> (<code>const char*</code>): Name of the Application that is issuing the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a></li>
<li><code>scenario</code> (<code>const char*</code>): Name of the Scenario that is issuing the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a></li>
<li><code>numArgs</code> (<code>int32_t</code>): Number of Additional Arguments to be passed as part of the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a></li>
<li><code>numArgs</code> (<code>uint32_t*</code>): List of Additional Arguments to be passed as part of the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a></li>
</ul>
<p><b>Returns:</b> <code>int8_t</code></p><ul>
<li><code>0</code>: If the <a class="el" href="classRequest.html" title="Encapsulation type for a Resource Provisioning Request.">Request</a> was successfully sent to the server.</li>
<li><code>-1</code>: Otherwise</li>
</ul>
<hr  />
 <div style="page-break-after: always;"></div><h3><a class="anchor" id="autotoc_md29"></a>
4.2.7. getProp</h3>
<p><b>Description:</b> Gets a property from the config file, this is used as property config file used for enabling or disabling internal features in uRM, can also be used by modules or clients to enable/disable features in their software based on property configs in uRM.</p>
<p><b>API Signature:</b> </p><div class="fragment"><div class="line">int8_t <a class="code hl_function" href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga8a0aa72f2dbe111acad6301f5889dadf">getProp</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* prop,</div>
<div class="line">               <span class="keywordtype">char</span>* buffer,</div>
<div class="line">               <span class="keywordtype">size_t</span> buffer_size,</div>
<div class="line">               <span class="keyword">const</span> <span class="keywordtype">char</span>* def_value);</div>
<div class="ttc" id="agroup__RESOURCE__TUNER__CLIENT__APIS_html_ga8a0aa72f2dbe111acad6301f5889dadf"><div class="ttname"><a href="group__RESOURCE__TUNER__CLIENT__APIS.html#ga8a0aa72f2dbe111acad6301f5889dadf">getProp</a></div><div class="ttdeci">int8_t getProp(const char *prop, char *buffer, size_t bufferSize, const char *defValue)</div><div class="ttdoc">Gets a property from the Config Store.</div></div>
</div><!-- fragment --><p><b>Parameters:</b></p>
<ul>
<li><code>prop</code> (<code>const char*</code>): Name of the Property to be fetched.</li>
<li><code>buffer</code> (<code>char*</code>): Pointer to a buffer to hold the result, i.e. the property value corresponding to the specified name.</li>
<li><code>buffer_size</code> (<code>size_t</code>): Size of the buffer.</li>
<li><code>def_value</code> (<code>const char*</code>): Value to be written to the buffer in case a property with the specified Name is not found in the Config Store</li>
</ul>
<p><b>Returns:</b> <code>int8_t</code></p><ul>
<li><code>0</code> If the Property was found in the store, and successfully fetched</li>
<li><code>-1</code> otherwise.</li>
</ul>
<h2><a class="anchor" id="autotoc_md30"></a>
4.3. Configs</h2>
<p>URM utilises YAML files for configuration. This includes the resources, signal config files. Target can provide their own config files, which are specific to their use-case through the extension interface</p>
<h3><a class="anchor" id="autotoc_md31"></a>
4.3.1. Initialization Configs</h3>
<p>Initialisation configs are mentioned in InitConfig.yaml file. This config enables URM to setup the required settings at the time of initialisation before any request processing happens. This also defines logical layer for clusters, cgroup ids, mpam partitions, etc for configs and apps to use, which promotes portability across targets and segments.</p>
<div class="fragment"><div class="line">InitConfigs:</div>
<div class="line">  - ClusterMap:</div>
<div class="line">    - Id: 0</div>
<div class="line">      Type: little</div>
<div class="line">    - Id: 1</div>
<div class="line">      Type: big</div>
<div class="line">    - Id: 2</div>
<div class="line">      Type: prime</div>
<div class="line">  - CgroupsInfo:</div>
<div class="line">    - Name: &quot;init.scope&quot;</div>
<div class="line">      Create: false</div>
<div class="line">      ID: 1</div>
<div class="line">    - Name: &quot;system.slice&quot;</div>
<div class="line">      Create: false</div>
<div class="line">      ID: 2</div>
<div class="line">    - Name: &quot;user.slice&quot;</div>
<div class="line">      Create: false</div>
<div class="line">      ID: 3</div>
<div class="line">    - Name: &quot;focused.slice/app.slice&quot;</div>
<div class="line">      Create: true</div>
<div class="line">      ID: 4</div>
</div><!-- fragment --><p><b>Fields Description for CGroup Config</b> </p><div class="fragment"><div class="line">| Field        | Type       | Description | Default Value |</div>
<div class="line">|--------------|------------|-------------|-----------------|</div>
<div class="line">| `ID`         | `int32_t`(Mandatory)| A 32-bit unique identifier for the CGroup | Not Applicable |</div>
<div class="line">| `Create`     | `boolean`(Optional) | Boolean flag indicating if the CGroup     |                |</div>
<div class="line">|              |                     | needs to be created by the URM server     | False          |</div>
<div class="line">| `IsThreaded` | `boolean`(Optional) | Indicate if cgroup is threaded            | False          |</div>
<div class="line">| `Name`       | `string` (Optional) | Descriptive name for the CGroup           | `Empty String` |</div>
</div><!-- fragment --><p>Common initialization configs are defined in /etc/urm/common/InitConfig.yaml</p>
<h3><a class="anchor" id="autotoc_md32"></a>
4.3.2. Resource Configs</h3>
<p>Tunable resources are specified via ResourcesConfig.yaml file.</p>
<p>Common resource configs are defined in /etc/urm/common/ResourcesConfig.yaml.</p>
<p>Each resource is defined with the following fields: <b>Fields Description</b> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ResID</code>   </td><td class="markdownTableBodyNone"><code>Integer</code> (Mandatory)   </td><td class="markdownTableBodyNone">unsigned 16-bit <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Identifier, unique within the <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Type.   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ResType</code>   </td><td class="markdownTableBodyNone"><code>Integer</code> (Mandatory)   </td><td class="markdownTableBodyNone">unsigned 8-bit integer, indicating the Type of the <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a>, for example: cpu / dcvs   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Name</code>   </td><td class="markdownTableBodyNone"><code>string</code> (Optional)   </td><td class="markdownTableBodyNone">Descriptive name   </td><td class="markdownTableBodyNone"><code>Empty String</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Path</code>   </td><td class="markdownTableBodyNone"><code>string</code> (Optional)   </td><td class="markdownTableBodyNone">Full resource path of sysfs or procfs file path (if applicable).   </td><td class="markdownTableBodyNone"><code>Empty String</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Supported</code>   </td><td class="markdownTableBodyNone"><code>boolean</code> (Optional)   </td><td class="markdownTableBodyNone">Indicates if the <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> is Eligible for Provisioning.   </td><td class="markdownTableBodyNone"><code>False</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>HighThreshold</code>   </td><td class="markdownTableBodyNone"><code>integer (int32_t)</code> (Mandatory)   </td><td class="markdownTableBodyNone">Upper threshold value for the resource.   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>LowThreshold</code>   </td><td class="markdownTableBodyNone"><code>integer (int32_t)</code> (Mandatory)   </td><td class="markdownTableBodyNone">Lower threshold value for the resource.   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Permissions</code>   </td><td class="markdownTableBodyNone"><code>string</code> (Optional)   </td><td class="markdownTableBodyNone">Type of client allowed to Provision this <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> (<code>system</code> or <code>third_party</code>).   </td><td class="markdownTableBodyNone"><code>third_party</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Modes</code>   </td><td class="markdownTableBodyNone"><code>array</code> (Optional)   </td><td class="markdownTableBodyNone">Display modes applicable (<code>"display_on"</code>, <code>"display_off"</code>, <code>"doze"</code>).   </td><td class="markdownTableBodyNone">0 (i.e. not supported in any Mode)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Policy</code>   </td><td class="markdownTableBodyNone"><code>string</code>(Optional)   </td><td class="markdownTableBodyNone">Concurrency policy (<code>"higher_is_better"</code>, <code>"lower_is_better"</code>, <code>"instant_apply"</code>, <code>"lazy_apply"</code>).   </td><td class="markdownTableBodyNone"><code>lazy_apply</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Unit</code>   </td><td class="markdownTableBodyNone"><code>string</code>(Optional)   </td><td class="markdownTableBodyNone">Translation Unit (<code>"MB"</code>, <code>"GB"</code>, <code>"KHz"</code>, <code>"Hz"</code> etc).   </td><td class="markdownTableBodyNone"><code>NA (multiplier = 1)</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ApplyType</code>   </td><td class="markdownTableBodyNone"><code>string</code> (Optional)   </td><td class="markdownTableBodyNone">Indicates if the resource can have different values, across different cores, clusters or cgroups.   </td><td class="markdownTableBodyNone"><code>global</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>TargetsEnabled</code>   </td><td class="markdownTableBodyNone"><code>array</code> (Optional)   </td><td class="markdownTableBodyNone">List of Targets on which this <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> should be available for tuning   </td><td class="markdownTableBodyNone"><code>Empty List</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>TargetsDisabled</code>   </td><td class="markdownTableBodyNone"><code>array</code> (Optional)   </td><td class="markdownTableBodyNone">List of Targets on which this <a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> should not be available for tuning   </td><td class="markdownTableBodyNone"><code>Empty List</code>   </td></tr>
</table>
<div class="fragment"><div class="line">ResourceConfigs:</div>
<div class="line">  - ResType: &quot;0x1&quot;</div>
<div class="line">    ResID: &quot;0x0&quot;</div>
<div class="line">    Name: &quot;RESTUNE_SCHED_UTIL_CLAMP_MIN&quot;</div>
<div class="line">    Path: &quot;/proc/sys/kernel/sched_util_clamp_min&quot;</div>
<div class="line">    Supported: true</div>
<div class="line">    HighThreshold: 1024</div>
<div class="line">    LowThreshold: 0</div>
<div class="line">    Permissions: &quot;third_party&quot;</div>
<div class="line">    Modes: [&quot;display_on&quot;, &quot;doze&quot;]</div>
<div class="line">    Policy: &quot;higher_is_better&quot;</div>
<div class="line"> </div>
<div class="line">  - ResType: &quot;0x1&quot;</div>
<div class="line">    ResID: &quot;0x1&quot;</div>
<div class="line">    Name: &quot;RESTUNE_SCHED_UTIL_CLAMP_MAX&quot;</div>
<div class="line">    Path: &quot;/proc/sys/kernel/sched_util_clamp_max&quot;</div>
<div class="line">    Supported: true</div>
<div class="line">    HighThreshold: 1024</div>
<div class="line">    LowThreshold: 0</div>
<div class="line">    Permissions: &quot;third_party&quot;</div>
<div class="line">    Modes: [&quot;display_on&quot;, &quot;doze&quot;]</div>
<div class="line">    Policy: &quot;lower_is_better&quot;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md33"></a>
4.3.3. Properties Config</h3>
<p>PropertiesConfig.yaml file stores various properties which are used by URM modules internally. For example, to allocate sufficient amount of memory for different types, or to determine the Pulse Monitor duration. Client can also use this as a property store to store their properties which gives it flexibility to control properties depending on the target.</p>
<div class="fragment"><div class="line">PropertyConfigs:</div>
<div class="line">  - Name: resource_tuner.maximum.concurrent.requests</div>
<div class="line">    Value: &quot;60&quot;</div>
<div class="line">  - Name: resource_tuner.maximum.resources.per.request</div>
<div class="line">    Value: &quot;64&quot;</div>
<div class="line">  - Name: resource_tuner.pulse.duration</div>
<div class="line">    Value: &quot;60000&quot;</div>
</div><!-- fragment --><p><b>Field Descriptions</b> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Name</code>   </td><td class="markdownTableBodyNone"><code>string</code> (Mandatory)   </td><td class="markdownTableBodyNone">Unique name of the property   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Value</code>   </td><td class="markdownTableBodyNone"><code>integer</code> (Mandatory)   </td><td class="markdownTableBodyNone">The value for the property.   </td><td class="markdownTableBodyNone">Not Applicable   </td></tr>
</table>
<p>Common resource configs are defined in /etc/urm/common/PropertiesConfig.yaml.</p>
<h3><a class="anchor" id="autotoc_md34"></a>
4.3.4. Signal Configs</h3>
<p>The file SignalsConfig.yaml defines the signal configs.</p>
<p><b>Field Descriptions</b> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SigId</code>   </td><td class="markdownTableBodyNone"><code>Integer</code> (Mandatory)   </td><td class="markdownTableBodyNone">16 bit unsigned <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> Identifier, unique within the signal category   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Category</code>   </td><td class="markdownTableBodyNone"><code>Integer</code> (Mandatory)   </td><td class="markdownTableBodyNone">8 bit unsigned integer, indicating the Category of the <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a>, for example: Generic, App Lifecycle.   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Type</code>   </td><td class="markdownTableBodyNone"><code>Integer</code> (optional)   </td><td class="markdownTableBodyNone">32 bit unsigned integer, indicating the type of signal ex. camera encode type, no.of multiple streams in cam encode, etc   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Name</code>   </td><td class="markdownTableBodyNone"><code>string</code> (Optional)   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><code>Empty String</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Enable</code>   </td><td class="markdownTableBodyNone"><code>boolean</code> (Optional)   </td><td class="markdownTableBodyNone">Indicates if the <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> is Eligible for Provisioning.   </td><td class="markdownTableBodyNone"><code>False</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>TargetsEnabled</code>   </td><td class="markdownTableBodyNone"><code>array</code> (Optional)   </td><td class="markdownTableBodyNone">List of Targets on which this <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> can be Tuned   </td><td class="markdownTableBodyNone"><code>Empty List</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>TargetsDisabled</code>   </td><td class="markdownTableBodyNone"><code>array</code> (Optional)   </td><td class="markdownTableBodyNone">List of Targets on which this <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> cannot be Tuned   </td><td class="markdownTableBodyNone"><code>Empty List</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Permissions</code>   </td><td class="markdownTableBodyNone"><code>array</code> (Optional)   </td><td class="markdownTableBodyNone">List of acceptable Client Level Permissions for tuning this <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a>   </td><td class="markdownTableBodyNone"><code>third_party</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Timeout</code>   </td><td class="markdownTableBodyNone"><code>integer</code> (Optional)   </td><td class="markdownTableBodyNone">Default <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> Tuning Duration to be used in case the Client specifies a value of 0 for duration in the tuneSignal API call.   </td><td class="markdownTableBodyNone"><code>1 (ms)</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Resources</code>   </td><td class="markdownTableBodyNone"><code>array</code> (Mandatory)   </td><td class="markdownTableBodyNone">List of Resources.   </td><td class="markdownTableBodyNone">Not Applicable   </td></tr>
</table>
<div style="page-break-after: always;"></div><p><b>Example</b> </p><div class="fragment"><div class="line"># camera encode multi-stream</div>
<div class="line"># encode (12+ streams)</div>
<div class="line">SignalConfigs:</div>
<div class="line">  - SigId: &quot;0x0004&quot;</div>
<div class="line">    Category: &quot;0x03&quot;</div>
<div class="line">    Type: 12</div>
<div class="line">    Name: URM_SIG_CAMERA_ENCODE_MULTI_STREAMS</div>
<div class="line">    Enable: true</div>
<div class="line">    TargetsEnabled: [&quot;qcm6490&quot;]</div>
<div class="line">    Permissions: [&quot;third_party&quot;, &quot;system&quot;]</div>
<div class="line">    Resources:</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_RUN_CORES&quot;, Values: [2, 0,1,2,3]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_RUN_CORES&quot;, Values: [3, 4,5,6,7]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_REL_CPU_WEIGHT&quot;, Values: [3, 90]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_HIGH_MEMORY&quot;, Values: [3, 1073741824]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_RUN_CORES&quot;, Values: [4, 0,1,2,3,4,5,6,7]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_REL_CPU_WEIGHT&quot;, Values: [4, 150]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_CPU_LATENCY&quot;, Values: [4, -20]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_LOW_MEMORY&quot;, Values: [4, 519430400]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_MIN_MEMORY&quot;, Values: [4, 119430400]}</div>
</div><!-- fragment --><p> Common <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> configs are defined in /etc/urm/common/SignalsConfig.yaml.</p>
<h3><a class="anchor" id="autotoc_md35"></a>
4.3.5. Per App Configs</h3>
<p>The file PerApp.yaml defines the per-app configs.</p>
<p><b>Field Descriptions</b> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>App</code>   </td><td class="markdownTableBodyNone"><code>String</code> (Mandatory)   </td><td class="markdownTableBodyNone">Name of the App, equivalent to process "comm"   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Threads</code>   </td><td class="markdownTableBodyNone"><code>array</code> (Optional)   </td><td class="markdownTableBodyNone">List of app threads (identified by their "comm" value as specified in /proc/{pid}/comm) to be considered as in-focus, hence moved to the focused-cgroup when the app (with the above identifier) is launched.   </td><td class="markdownTableBodyNone"><code>Empty List</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Configurations</code>   </td><td class="markdownTableBodyNone"><code>array</code> (optional)   </td><td class="markdownTableBodyNone">List of <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> Configurations indicating the signals to be acquired when this app is launched. Note: The specified signal opcodes should correspond to actual configurations in the SignalsConfig.yaml file.   </td><td class="markdownTableBodyNone"><code>Empty List</code>   </td></tr>
</table>
<div style="page-break-after: always;"></div><p><b>Example</b> </p><div class="fragment"><div class="line">PerAppConfigs:</div>
<div class="line">  - App: &quot;gst-launch-&quot;</div>
<div class="line">    Threads:</div>
<div class="line">       - {&quot;cam-server&quot;: &quot;4&quot;}</div>
<div class="line">       - {&quot;gst-launch-&quot;: &quot;4&quot;}</div>
<div class="line"> </div>
<div class="line">  - App: &quot;chrome&quot;</div>
<div class="line">    Threads:</div>
<div class="line">       - {&quot;chrome&quot;: &quot;FOCUSED_CGROUP_IDENTIFIER&quot;}</div>
<div class="line">    Configurations: [&quot;0x80034aab&quot;]</div>
</div><!-- fragment --><p>PerApp configs should be defined in /etc/urm/custom/PerApp.yaml.</p>
<h2><a class="anchor" id="autotoc_md36"></a>
5. Client CLI</h2>
<p>URM provides a minimal CLI to interact with the server. This is provided to help with development and debugging purposes.</p>
<h3><a class="anchor" id="autotoc_md37"></a>
5.1. Send a Tune Request</h3>
<div class="fragment"><div class="line">/usr/bin/urmCli --tune --duration &lt;&gt; --priority &lt;&gt; --num &lt;&gt; --res &lt;&gt;</div>
</div><!-- fragment --><p> Where:</p><ul>
<li><code>duration</code>: Duration in milliseconds for the tune request</li>
<li><code>priority</code>: Priority level for the tune request (HIGH: 0 or LOW: 1)</li>
<li><code>num</code>: Number of resources</li>
<li><code>res</code>: List of resource ResCode, ResInfo (optional) and Values to be tuned as part of this request</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line"># Single Resource in a Request</div>
<div class="line">/usr/bin/urmCli --tune --duration 5000 --priority 0 --num 1 --res &quot;65536:700&quot;</div>
<div class="line"> </div>
<div class="line"># Multiple Resources in single Request</div>
<div class="line">/usr/bin/urmCli --tune --duration 4400 --priority 1 --num 2 --res &quot;0x80030000:700,0x80040001:155667&quot;</div>
<div class="line"> </div>
<div class="line"># Multi-Valued Resource</div>
<div class="line">/usr/bin/urmCli --tune --duration 9500 --priority 0 --num 1 --res &quot;0x00090002:0,0,1,3,5&quot;</div>
<div class="line"> </div>
<div class="line"># Specifying ResInfo (useful for Core and Cluster type Resources)</div>
<div class="line">/usr/bin/urmCli --tune --duration 5000 --priority 0 --num 1 --res &quot;0x00040000#0x00000100:1620438&quot;</div>
<div class="line"> </div>
<div class="line"># Everything at once</div>
<div class="line">/usr/bin/urmCli --tune --duration 6500 --priority 0 --num 2 --res &quot;0x00030000:800;0x00040011#0x00000101:50000,100000&quot;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md38"></a>
5.2. Send an Untune Request</h3>
<div class="fragment"><div class="line">/usr/bin/urmCli --untune --handle &lt;&gt;</div>
</div><!-- fragment --><p> Where:</p><ul>
<li><code>handle</code>: Handle of the previously issued tune request, which needs to be untuned</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line">/usr/bin/urmCli --untune --handle 50</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md39"></a>
5.3. Send a Retune Request</h3>
<div class="fragment"><div class="line">/usr/bin/urmCli --retune --handle &lt;&gt; --duration &lt;&gt;</div>
</div><!-- fragment --><p> Where:</p><ul>
<li><code>handle</code>: Handle of the previously issued tune request, which needs to be retuned</li>
<li><code>duration</code>: The new duration in milliseconds for the tune request</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line">/usr/bin/urmCli --retune --handle 7 --duration 8000</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md40"></a>
5.4. Send a getProp Request</h3>
<div class="fragment"><div class="line">/usr/bin/urmCli --getProp --key &lt;&gt;</div>
</div><!-- fragment --><p> Where:</p><ul>
<li><code>key</code>: The Prop name of which the corresponding value needs to be fetched</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line">/usr/bin/urmCli --getProp --key &quot;urm.logging.level&quot;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md41"></a>
5.5. Send a tuneSignal Request</h3>
<div class="fragment"><div class="line">/usr/bin/urmCli --signal --scode &lt;&gt;</div>
</div><!-- fragment --><p> Where:</p><ul>
<li><code>key</code>: The Prop name of which the corresponding value needs to be fetched</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line">/usr/bin/urmCli --signal --scode &quot;0x00fe0ab1&quot;</div>
</div><!-- fragment --><div style="page-break-after: always;"></div><h1><a class="anchor" id="autotoc_md42"></a>
6. Customizations &amp; Extensions</h1>
<ul>
<li>Extension Interface</li>
<li>Custom Configs</li>
<li>Extension Features</li>
</ul>
<h2><a class="anchor" id="autotoc_md43"></a>
6.1. Extensions Interface</h2>
<p>The URM extesnion framework allows target chipsets to extend its functionality and customize it to their use-case. Extension interface essentially provides a series of hooks to the targets or other modules to add their own custom behaviour. This is achieved through a lightweight extension interface. This happens in the initialisation phase before the service is ready for requests.</p>
<p>Specifically the extension interface provides the following capabilities:</p><ul>
<li>Registering custom resource handlers</li>
<li>Registering custom configuration files</li>
<li>Extension features</li>
</ul>
<p><b>Extension APIs</b></p>
<h3><a class="anchor" id="autotoc_md44"></a>
6.1.1. Registering Resource Callbacks</h3>
<p>Registers a custom resource applier (URM_REGISTER_RES_APPLIER_CB) handler with the system. This allows the framework to invoke a user-defined callback when a tune request for a specific resource opcode is encountered. A function pointer to the callback is to be registered. Now, instead of the default resource handler (provided by URM), this callback function will be called when a resource provisioning request for this particular resource opcode arrives.</p>
<p>Registers a custom resource teardown handler (URM_REGISTER_RES_TEAR_CB) with the system. This allows the framework to invoke a user-defined callback when an untune request for a specific resource opcode is encountered. A function pointer to the callback is to be registered. Now, instead of the normal resource handler (provided by URM), this callback function will be called when a resource deprovisioning request for this particular resource opcode arrives.</p>
<p><b>Usage Example</b></p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> applyCustomCpuFreqCustom(<span class="keywordtype">void</span>* res) {</div>
<div class="line">    <span class="comment">// Custom logic to apply CPU frequency</span></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">URM_REGISTER_RES_APPLIER_CB(0x00010001, applyCustomCpuFreqCustom);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="keywordtype">void</span> resetCustomCpuFreqCustom(<span class="keywordtype">void</span>* res) {</div>
<div class="line">    <span class="comment">// Custom logic to clear currently applied CPU frequency</span></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">URM_REGISTER_RES_TEAR_CB(0x00010001, resetCustomCpuFreqCustom);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md45"></a>
6.1.2. Registering Custom Configs</h3>
<p>Custom config files either can be placed in /etc/urm/custom or Registers a custom configuration (URM_REGISTER_CONFIG) YAML file. This enables target chipset to provide their own config files, i.e. allowing them to provide their own custom resources for example.</p>
<p><b>Usage Example</b></p>
<div class="fragment"><div class="line">URM_REGISTER_CONFIG(RESOURCE_CONFIG, <span class="stringliteral">&quot;/etc/custom_dir/targetResourceConfigCustom.yaml&quot;</span>);</div>
</div><!-- fragment --><p> The above line of code, will tell URM to read the resource configs from the file "/etc/custom_dir/targetResourceConfigCustom.yaml" instead of the default file. Note: the target chipset must honour the structure of the YAML files, for them to be read and registered successfully.</p>
<p>Custom signal config file can be specified similarly:</p>
<div class="fragment"><div class="line">URM_REGISTER_CONFIG(SIGNALS_CONFIG, <span class="stringliteral">&quot;/etc/bin/targetSignalConfigCustom.yaml&quot;</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md46"></a>
6.2. Custom Configs</h2>
<p>uRM allows to add custom configs and override configs items. It also provides additional configs.</p>
<h3><a class="anchor" id="autotoc_md47"></a>
6.2.1. Initialization Configs</h3>
<p>Custom init configs can be added to init config yaml. New init sections can be defined. For example "ClusterMap" can be redefined if your target has 4 clusters. Also you can define new section like MPAMgroupsInfo, see the example below.</p>
<div class="fragment"><div class="line">InitConfigs:</div>
<div class="line">  # Logical IDs should always be arranged from lower to higher cluster capacities</div>
<div class="line">  - ClusterMap:</div>
<div class="line">    - Id: 0</div>
<div class="line">      Type: cluster0</div>
<div class="line">    - Id: 1</div>
<div class="line">      Type: cluster1</div>
<div class="line">    - Id: 2</div>
<div class="line">      Type: cluster2</div>
<div class="line">    - Id: 3</div>
<div class="line">      Type: cluster3</div>
<div class="line"> </div>
<div class="line">  - MPAMgroupsInfo:</div>
<div class="line">    - Name: &quot;default&quot;</div>
<div class="line">      ID: 0</div>
<div class="line">      Priority: 0</div>
<div class="line">    - Name: &quot;camera-mpam-group&quot;</div>
<div class="line">      ID: 1</div>
<div class="line">      Priority: 1</div>
<div class="line">    - Name: &quot;audio-mpam-group&quot;</div>
<div class="line">      ID: 2</div>
<div class="line">      Priority: 2</div>
<div class="line">    - Name: &quot;video-mpam-group&quot;</div>
<div class="line">      ID: 3</div>
<div class="line">      Priority: 3</div>
<div class="line"> </div>
<div class="line">  - CacheInfo:</div>
<div class="line">    - Type: L2</div>
<div class="line">      NumCacheBlocks: 2</div>
<div class="line">      PriorityAware: 0</div>
<div class="line">    - Type: L3</div>
<div class="line">      NumCacheBlocks: 1</div>
<div class="line">      PriorityAware: 1</div>
</div><!-- fragment --><p>Fields Description for Mpam Group Config </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ID</code>   </td><td class="markdownTableBodyNone"><code>int32_t</code>(Mandatory)   </td><td class="markdownTableBodyNone">A 32-bit unique identifier   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">for the Mpam Group   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Priority</code>   </td><td class="markdownTableBodyNone"><code>int32_t</code>(Optional)   </td><td class="markdownTableBodyNone">Mpam Group Priority   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Name</code>   </td><td class="markdownTableBodyNone"><code>string</code> (Optional)   </td><td class="markdownTableBodyNone">Descriptive name for the   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Mpam Group   </td><td class="markdownTableBodyNone"><code>Empty String</code>   </td></tr>
</table>
<p>Fields Description for Cache Info Config</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Type</code>   </td><td class="markdownTableBodyNone"><code>string</code> (Mandatory)   </td><td class="markdownTableBodyNone">Type of cache (L2 or L3)   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">for which config is intended   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>NumCacheBlocks</code>   </td><td class="markdownTableBodyNone"><code>int32_t</code>(Mandatory)   </td><td class="markdownTableBodyNone">Number of Cache blocks for   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">the above mentioned type,   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">to be managed by URM   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>PriorityAware</code>   </td><td class="markdownTableBodyNone"><code>boolean</code>(Optional)   </td><td class="markdownTableBodyNone">Boolean flag indicating if   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">the Cache Type supports   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">different Priority Levels   </td><td class="markdownTableBodyNone"><code>false</code>   </td></tr>
</table>
<p>Initialisation configs can be customized. Entire init config file can be overided by</p><ul>
<li>Targets can override initialization configs (in addition to common init configs, i.e. overrides specific configs) by simply pushing its own InitConfig.yaml into /etc/urm/custom/InitConfig.yaml</li>
<li>register with extension interface URM_REGISTER_CONFIG(INIT_CONFIG, "/bin/InitConfigCustom.yaml");</li>
</ul>
<h3><a class="anchor" id="autotoc_md48"></a>
6.2.2. Resource Configs</h3>
<p>Custom resources can be added to resources config yaml. New resources can be defined. For example "MY_OWN_CPU_SCHED_RESOURCE" defined in the example below in sched resource type (you can also choose custom resource type), and ID is taken next resource ID available after upstream resources, resource ID can also be any custom ID that you choose if you want.</p>
<div class="fragment"><div class="line">ResourceConfigs:</div>
<div class="line">  - ResType: &quot;0x3&quot;</div>
<div class="line">    ResID: &quot;0x10&quot;</div>
<div class="line">    Name: &quot;MY_OWN_CPU_SCHED_RESOURCE&quot;</div>
<div class="line">    Path: &quot;/proc/sys/kernel/sched_up_down_migrate&quot;</div>
<div class="line">    Supported: true</div>
<div class="line">    HighThreshold: 1024</div>
<div class="line">    LowThreshold: 0</div>
<div class="line">    Permissions: &quot;third_party&quot;</div>
<div class="line">    Modes: [&quot;display_on&quot;, &quot;doze&quot;]</div>
<div class="line">    Policy: &quot;higher_is_better&quot;</div>
</div><!-- fragment --><p> Resources config yaml file can be given in one of the below ways</p><ul>
<li>Targets can override resource configs by simply pushing its own ResourcesConfig.yaml into /etc/urm/custom/ResourcesConfig.yaml</li>
<li>Register your resources config with URM_REGISTER_CONFIG(RESOURCE_CONFIG, "/bin/targetResourceConfigCustom.yaml");</li>
</ul>
<div style="page-break-after: always;"></div><h3><a class="anchor" id="autotoc_md49"></a>
6.2.3. Properties Config</h3>
<p>Custom properties can be added to properties config yaml. Default property can be overridden or new properties can be defined. For example "resource_tuner.maximum.concurrent.requests" default property overridden with new value, and a new property "user_own_property" defined in the example below</p>
<div class="fragment"><div class="line">PropertyConfigs:</div>
<div class="line">  - Name: resource_tuner.maximum.concurrent.requests</div>
<div class="line">    Value: &quot;5&quot;</div>
<div class="line">  - Name: user_own_property</div>
<div class="line">    Value: &quot;64&quot;</div>
</div><!-- fragment --><p> Properties config yaml file can be given in one of the below ways</p><ul>
<li>Targets can override properties configs by placing "PropertiesConfig.yaml" into /etc/urm/custom/PropertiesConfig.yaml</li>
<li>Register your property config with URM_REGISTER_CONFIG(PROPERTIES_CONFIG, "/bin/targetPropertiesConfigCustom.yaml");</li>
</ul>
<div style="page-break-after: always;"></div><h3><a class="anchor" id="autotoc_md50"></a>
6.2.4. Signal Configs</h3>
<p>Custom signal configs can be added to signals config yaml. New signal configs can be defined. For example "URM_SIG_VIDEO_DECODE" is defined in the example below, you can use custom signal category, Id, and resources.</p>
<div class="fragment"><div class="line">SignalConfigs:</div>
<div class="line">  # Video decode</div>
<div class="line">  # Default decode 30 fps</div>
<div class="line">  - SigId: &quot;0x0001&quot;</div>
<div class="line">    Category: &quot;0x03&quot;</div>
<div class="line">    Name: &quot;URM_SIG_VIDEO_DECODE&quot;</div>
<div class="line">    Enable: true</div>
<div class="line">    TargetsEnabled: [&quot;qcm6490&quot;]</div>
<div class="line">    Permissions: [&quot;third_party&quot;, &quot;system&quot;]</div>
<div class="line">    Resources:</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_RUN_CORES&quot;, Values: [2, 0,1,2,3]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_RUN_CORES&quot;, Values: [3, 4,5,6]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_REL_CPU_WEIGHT&quot;, Values: [3, 90]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_HIGH_MEMORY&quot;, Values: [3, 1073741824]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_RUN_CORES&quot;, Values: [4, 0,1,2,3,4,5,6]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_REL_CPU_WEIGHT&quot;, Values: [4, 150]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_CPU_LATENCY&quot;, Values: [4, -20]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_LOW_MEMORY&quot;, Values: [4, 519430400]}</div>
<div class="line">      - {ResCode: &quot;RES_CGRP_MIN_MEMORY&quot;, Values: [4, 119430400]}</div>
<div class="line">      - {ResCode: &quot;RES_SCALING_MAX_FREQ&quot;, ResInfo: &quot;CLUSTER_LITTLE_ALL_CORES&quot;, Values: [940800]}</div>
<div class="line">      - {ResCode: &quot;RES_SCALING_MAX_FREQ&quot;, ResInfo: &quot;CLUSTER_BIG_ALL_CORES&quot;, Values: [940800]}</div>
<div class="line">      - {ResCode: &quot;RES_SCALING_MAX_FREQ&quot;, ResInfo: &quot;CLUSTER_PLUS_ALL_CORES&quot;, Values: [940800]}</div>
</div><!-- fragment --><p> <a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> config yaml file can be given in one of the below ways</p><ul>
<li>Targets can override signal configs by simply pushing its own SignalsConfig.yaml into /etc/urm/custom/SignalsConfig.yaml</li>
<li>Register your signals config with URM_REGISTER_CONFIG(SIGNALS_CONFIG, "/bin/targetSignalConfigCustom.yaml");</li>
</ul>
<div style="page-break-after: always;"></div><h3><a class="anchor" id="autotoc_md51"></a>
6.2.5. Target Configs</h3>
<p>The file TargetConfig.yaml defines the target configs, note this is an optional config, i.e. this file need not necessarily be provided. uRM can dynamically fetch system info, like target name, logical to physical core / cluster mapping, number of cores etc. Use this file, if you want to provide this information explicitly. If the TargetConfig.yaml is provided, URM will always overide default dynamically generated target information with given config and use it. Also note, there are no field-level default values available if the TargetConfig.yaml is provided. Hence if you wish to provide this file, then you'll need to provide all the complete required information.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>TargetName</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">Target Identifier   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="structClusterInfo.html" title="Representation for various Clusters detected on the device.">ClusterInfo</a></code>   </td><td class="markdownTableBodyNone"><code>array</code>   </td><td class="markdownTableBodyNone">Cluster ID to Type Mapping   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ClusterSpread</code>   </td><td class="markdownTableBodyNone"><code>array</code>   </td><td class="markdownTableBodyNone">Cluster ID to Per Cluster Core Count Mapping   </td><td class="markdownTableBodyNone">Not Applicable   </td></tr>
</table>
<div class="fragment"><div class="line">TargetConfig:</div>
<div class="line">  - TargetName: [&quot;QCS9100&quot;]</div>
<div class="line">    ClusterInfo:</div>
<div class="line">      - LgcId: 0</div>
<div class="line">        PhyId: 4</div>
<div class="line">      - LgcId: 1</div>
<div class="line">        PhyId: 0</div>
<div class="line">      - LgcId: 2</div>
<div class="line">        PhyId: 9</div>
<div class="line">      - LgcId: 3</div>
<div class="line">        PhyId: 7</div>
<div class="line">    ClusterSpread:</div>
<div class="line">      - PhyId: 0</div>
<div class="line">        NumCores: 4</div>
<div class="line">      - PhyId: 4</div>
<div class="line">        NumCores: 3</div>
<div class="line">      - PhyId: 7</div>
<div class="line">        NumCores: 2</div>
<div class="line">      - PhyId: 9</div>
<div class="line">        NumCores: 1</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md52"></a>
6.3. Extension Features</h2>
<p>The file ExtFeaturesConfig.yaml defines the Extension Features, note this is an optional config, i.e. this file need not necessarily be provided. Use this file to specify your own custom features. Each feature is associated with it's own library and an associated list of signals. Whenever a relaySignal API request is received for any of these signals, URM will forward the request to the corresponding library. The library is required to implement the following 3 functions:</p><ul>
<li>initFeature</li>
<li>tearFeature</li>
<li>relayFeature Refer the Examples section for more details on how to use the relaySignal API.</li>
</ul>
<p><b>Field Descriptions</b></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>FeatId</code>   </td><td class="markdownTableBodyNone"><code>Integer</code>   </td><td class="markdownTableBodyNone">unsigned 32-bit Unique Feature Identifier   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>LibPath</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">Path to the associated library   </td><td class="markdownTableBodyNone">Not Applicable    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Signals</code>   </td><td class="markdownTableBodyNone"><code>array</code>   </td><td class="markdownTableBodyNone">List of signals to subscribe the feature to   </td><td class="markdownTableBodyNone">Not Applicable   </td></tr>
</table>
<p><b>Example Config:</b></p>
<div class="fragment"><div class="line">FeatureConfigs:</div>
<div class="line">  - FeatId: &quot;0x00000001&quot;</div>
<div class="line">    Name: &quot;FEAT-1&quot;</div>
<div class="line">    LibPath: &quot;rlib2.so&quot;</div>
<div class="line">    Description: &quot;Simple Algorithmic Feature, defined by the BU&quot;</div>
<div class="line">    Signals: [&quot;0x00050000&quot;, &quot;0x00050001&quot;]</div>
<div class="line"> </div>
<div class="line">  - FeatId: &quot;0x00000002&quot;</div>
<div class="line">    Name: &quot;FEAT-2&quot;</div>
<div class="line">    LibPath: &quot;rlib1.so&quot;</div>
<div class="line">    Description: &quot;Simple Observer-Observable Feature, defined by the BU&quot;</div>
<div class="line">    Subscribers: [&quot;0x00050000&quot;, &quot;0x00050002&quot;]</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md53"></a>
7. URM Implementation Details</h1>
<h2><a class="anchor" id="autotoc_md54"></a>
7.1. Project Structure</h2>
<div class="fragment"><div class="line">.</div>
<div class="line">├── client</div>
<div class="line">├── configs</div>
<div class="line">├── contextual-classifier</div>
<div class="line">├── debian</div>
<div class="line">├── docs</div>
<div class="line">├── extensions</div>
<div class="line">├── modula</div>
<div class="line">├── public_headers</div>
<div class="line">└── resource-tuner</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md55"></a>
7.2. Userspace Resource Manager Key Points</h2>
<p>Userspace resource manager (uRM) contains</p><ul>
<li>Userspace resource manager (uRM) exposes a variery of APIs for resource tuning and use-case/scenario tuning</li>
<li>These APIs can be used by apps, features and other modules</li>
<li>Using these APIs, client can tune any system resource parameters like cpu, dcvs, min / max frequencies etc.</li>
<li>Userspace resource manager (uRM) provides</li>
</ul>
<h3><a class="anchor" id="autotoc_md56"></a>
7.2.1. Contextual Classifier</h3>
<p>The Contextual Classifier is an optional module designed to identify the static context of workloads (e.g., whether an application is a game, multimedia app, or browser) based on an offline-trained model.</p>
<p><b>Key functionalities include:</b></p><ul>
<li><b>Process Event Monitoring:</b> Monitors process creation and termination events via Netlink.</li>
<li><b>Process Classification:</b> Classifies workloads (e.g., game, multimedia) using fastText (if enabled at build time). If fastText is not built, a default inference mechanism that always classifies the workload as an application.</li>
<li><b><a class="el" href="classSignal.html" title="Encapsulation type for a Signal Tuning Request.">Signal</a> Generation:</b> Retrieves specific signal details based on classified workload types.</li>
<li><b>Cgroup Management:</b> Dynamically manages cgroups by moving application threads to designated cgroups.</li>
<li><b>Action Application:</b> Calls <code>ApplyActions</code> to send tuning requests and <code>RemoveActions</code> to untune for process events.</li>
<li><b>Configurability:</b> Influenced by configuration files such as <code>fasttext_model_supervised.bin</code>, <code>classifier-blocklist.txt</code>, and <code>ignore-tokens.txt</code>.</li>
</ul>
<p><b>Flow of Events:</b></p>
<div class="fragment"><div class="line">+---------------------------+</div>
<div class="line">| Process Event Listener    |</div>
<div class="line">|       (NetLinkComm)       |</div>
<div class="line">+-------------+-------------+</div>
<div class="line">              |</div>
<div class="line">              | Catches process events (e.g., fork, exec, exit)</div>
<div class="line">              v</div>
<div class="line">+---------------------------+</div>
<div class="line">|      HandleProcEv()       |</div>
<div class="line">| (Filters and queues events)|</div>
<div class="line">+-------------+-------------+</div>
<div class="line">              |</div>
<div class="line">              | Notifies worker thread</div>
<div class="line">              v</div>
<div class="line">+---------------------------+</div>
<div class="line">|     ClassifierMain()      |</div>
<div class="line">|    (Worker Thread)        |</div>
<div class="line">+-------------+-------------+</div>
<div class="line">              |</div>
<div class="line">              +----(Event Type)-----+</div>
<div class="line">              |                     |</div>
<div class="line">              v                     v</div>
<div class="line">        +------------+        +-------------+</div>
<div class="line">        | CC_APP_OPEN|        | CC_APP_CLOSE|</div>
<div class="line">        +-----+------+        +-----+-------+</div>
<div class="line">              |                     |</div>
<div class="line">              v                     v</div>
<div class="line">   +-----------------------+    +---------------------------+</div>
<div class="line">   | Is Ignored Process?   |---&gt;| Move Process to Original  |</div>
<div class="line">   | (classifier-blocklist)|    |   Cgroup                  |</div>
<div class="line">   +----------+------------+    +---+-----------------------+</div>
<div class="line">              |  No                 |</div>
<div class="line">              v                     v</div>
<div class="line">   +---------------------+   +---------------------------+</div>
<div class="line">   |  ClassifyProcess()  |   |   RemoveActions           |</div>
<div class="line">   | (MLInference model) |   |    (untuneSignal)         |</div>
<div class="line">   +----------+----------+   +---------------------------+</div>
<div class="line">              |</div>
<div class="line">              v</div>
<div class="line">   +---------------------+</div>
<div class="line">   | GetSignalDetailsFor |</div>
<div class="line">   |      Workload()     |</div>
<div class="line">   +----------+----------+</div>
<div class="line">              |</div>
<div class="line">              v</div>
<div class="line">   +----------------------------+</div>
<div class="line">   | MoveAppThreadsToCGroup()   |</div>
<div class="line">   | (Assign to Focused Cgroup) |</div>
<div class="line">   +----------+-----------------+</div>
<div class="line">              |</div>
<div class="line">              v</div>
<div class="line">   +---------------------+</div>
<div class="line">   |    ApplyActions     |</div>
<div class="line">   |    (tuneSignal)     |</div>
<div class="line">   +---------------------+</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md57"></a>
7.2.2. Resource Tuner</h3>
<ul>
<li>Queued requests processed by resource Tuner</li>
<li>Set of Yaml config files provides extensive configuration capability</li>
<li>Tuning resources provides control over system resources like CPU, Caches, GPU, etc for. Example changing the operating point of CPU DCVS min-freq to 1GHz to improve performance or limiting its max frequency to 1.5GHz to save power</li>
<li>Tuning Signals dynamically provisions the system resources for a use case or scenario such as apps launches, installations, etc. in response to received signal. Resources can be configured in yaml for signals.</li>
<li>Signals pick resources related to signal from SignalsConfig.yaml</li>
<li>Extension interface provides a way to customize URM behaviour, by specifying custom resources, custom signals and features.</li>
<li>URM uses YAML based config files, for fetching information relating to resources/signals and properties.</li>
</ul>
<div class="fragment"><div class="line">              |</div>
<div class="line">              | Tune/Untune Requests</div>
<div class="line">              v</div>
<div class="line">+---------------------------+</div>
<div class="line">|           API             |</div>
<div class="line">|           ---             |</div>
<div class="line">|          Client           |</div>
<div class="line">+-------------+-------------+</div>
<div class="line">              |</div>
<div class="line">          (sockets)</div>
<div class="line">              | </div>
<div class="line">              v</div>
<div class="line">     .----------------.                    .--------------.</div>
<div class="line">    (                  )                  (                )</div>
<div class="line">    (      Server      )----(periodic)---&gt;( Pulse monitor  )</div>
<div class="line">    (                  )                  (                )</div>
<div class="line">     .--------+-------.                    .--------------.</div>
<div class="line">              |</div>
<div class="line">              +----(Init)-----------+---------------+-----------+</div>
<div class="line">              |                     |               |           |</div>
<div class="line">              v                     v               |           v</div>
<div class="line">        +------------+        +------------------+  |   +------------------+</div>
<div class="line">        | Duplicate  |        | Upstream Configs,|  |   | Custom resources |</div>
<div class="line">        |  Checker   |        | Resources        |  |   |    &amp; features    |</div>
<div class="line">        +-----+------+        +-----+------------+  |   +------------------+</div>
<div class="line">              |                                     |</div>
<div class="line">              v                                     v</div>
<div class="line">        +------------+                    +--------------------+</div>
<div class="line">        |  Handle    |                    |   Target specific  |</div>
<div class="line">        |  Generator |                    |   configs          |</div>
<div class="line">        +-----+------+                    +--------------------+</div>
<div class="line">              |     </div>
<div class="line">              v       </div>
<div class="line">        +------------+          .----------.          +---------------+</div>
<div class="line">        |  Queue     |         (  Process   )         |               |</div>
<div class="line">        |  Requests  |   ...   (  Requests  )--------&gt;|  Authorizer   |</div>
<div class="line">        |            |         (            )         |               |</div>
<div class="line">        +------------+          .----------.          +-------+-------+</div>
<div class="line">                                                              |</div>
<div class="line">                                                              v</div>
<div class="line">          +--------------+      +---------------+     +---------------+</div>
<div class="line">          | Concurrency  |      | Action        |     |               |</div>
<div class="line">          | Coordinator  |&lt;-----+ Thresholds    |&lt;----+ Rate Limiter  |</div>
<div class="line">          |              |      |               |     |               |</div>
<div class="line">          +------+-------+      +---------------+     +---------------+</div>
<div class="line">                 |</div>
<div class="line">                 v</div>
<div class="line">          +--------------+</div>
<div class="line">          |    Action    |</div>
<div class="line">          +--------------+</div>
</div><!-- fragment --><p><a class="el" href="classResource.html" title="Used to store information regarding Resources / Tunables which need to be Provisioned as part of the ...">Resource</a> Tuner architecture is captured above.</p>
<h3><a class="anchor" id="autotoc_md58"></a>
7.2.3. URM Initialization</h3>
<ul>
<li>During the server initialization phase, the YAML config files are read to build up the resource registry, property store etc.</li>
<li>If the target chipset has registered any custom resources, signals or custom YAML files via the extension interface, then these changes are detected during this phase itself to build up a consolidated system view, before it can start serving requests.</li>
<li>During the initialization phase, memory is pre-allocated for commonly used types (via MemoryPool), and worker (thread) capacity is reserved in advance via the ThreadPool, to avoid any delays during the request processing phase.</li>
<li>URM will also fetch the target details, like target name, total number of cores, logical to physical cluster / core mapping in this phase.</li>
<li>If the Signals module is plugged in, it will be initialized as well and the signal configs will be parsed similarly to resource configs.</li>
<li>Once all the initialization is completed, the server is ready to serve requests, a new listener thread is created for handling requests.</li>
</ul>
<h3><a class="anchor" id="autotoc_md59"></a>
7.2.4. Request Processing</h3>
<ul>
<li>The client can use the URM client library to send their requests.</li>
<li>URM supports sockets and binders for client-server communication.</li>
<li>As soon as the request is received on the server end, a handle is generated and returned to the client. This handle uniquely identifies the request and can be used for subsequent retune (retuneResources) or untune (untuneResources) API calls.</li>
<li>The request is submitted to the ThreadPool for async processing.</li>
<li>When the request is picked up by a worker thread (from the ThreadPool), it will decode the request message and then validate the request.</li>
<li>The request verifier, will run a series of checks on the request like permission checks, and on the resources part of the request, like config value bounds check.</li>
<li>Once request is verified, a duplicate check is performed, to verify if the client has already submitted the same request before. This is done so as to the improve system efficiency and performace.</li>
<li>Next the request is added to an queue, which is essentially PriorityQueue, which orders requests based on their priorities (for more details on Priority Levels, refer the next Section). This is done so that the request with the highest priority is always served first.</li>
<li>To handle concurrent requests for the same resource, we maintain resource level linked lists of pending requests, which are ordered according to the request priority and resource policy. This ensures that the request with the higher priority will always be applied first. For two requests with the same priority, the application order will depend on resource policy. For example, in case of resource with "higher is better" policy, the request with a higher configuration value for the resource shall take effect first.</li>
<li>Once a request reaches the head of the resource level linked list, it is applied, i.e. the config value specified by this request for the resource takes effect on the corresponding sysfs node.</li>
<li>A timer is created and used to keep track of a request, i.e. check if it has expired. Once it is detected that the request has expired an untune request for the same handle as this request, is automatically generated and submitted, it will take care of resetting the effected resource nodes to their original values.</li>
<li>Client modules can provide their own custom resource actions for any resource. The default action provided by URM is writing to the resource sysfs node.</li>
</ul>
<p><b>Here is a more detailed explanation of the key features discussed above:</b></p>
<h2><a class="anchor" id="autotoc_md60"></a>
7.3. Client-Level Permissions</h2>
<p>Certain resources can be tuned only by system clients and some which have no such restrictions and can be tuned even by third party clients. The client permissions are dynamically determined, the first time it makes a request. If a client with third party permissions tries to tune a resource, which allows only clients with system permissions to tune it, then the request shall be dropped.</p>
<h2><a class="anchor" id="autotoc_md61"></a>
7.4. Resource-Level Policies</h2>
<p>To ensure efficient and predictable handling of concurrent requests, each system resource is governed by one of four predefined policies. Selecting the appropriate policy helps maintain system stability, optimize performance/power, and align resource behavior with application requirements.</p>
<ul>
<li>Instant Apply: This policy is for resources where the latest request needs to be honored. This is kept as the default policy.</li>
<li>Higher is better: This policy honors the request writing the highest value to the node. One of the cases where this makes sense is for resources that describe the upper bound value. By applying the higher-valued request, the lower-valued request is implicitly honored.</li>
<li>Lower is better: Works exactly opposite of the higher is better policy.</li>
<li>Lazy Apply: Sometimes, you want the resources to apply requests in a first-in-first-out manner.</li>
</ul>
<h2><a class="anchor" id="autotoc_md62"></a>
7.5. Request-Level Priorities</h2>
<p>As part of the tuneResources API call, client is allowed to specify a desired priority level for the request. URM supports 2 priority levels:</p><ul>
<li>High</li>
<li>Low</li>
</ul>
<p>However when multiplexed with client-level permissions, effetive request level priorities would be</p><ul>
<li>System High [SH]</li>
<li>System Low [SL]</li>
<li>Third Party High (or Regular High) [TPH]</li>
<li>Third Party Low (or Regular Low) [TPL]</li>
</ul>
<p>Requests with a higher priority will always be prioritized, over another request with a lower priority. Note, the request priorities are related to the client permissions. A client with system permission is allowed to acquire any priority level it wants, however a client with third party permissions can only acquire either third party high (TPH) or third party low (TPL) level of priorities. If a client with third party permissions tries to acquire a System High or System Low level of priority, then the request will not be honoured.</p>
<h2><a class="anchor" id="autotoc_md63"></a>
7.6. Pulse Monitor: Detection of Dead Clients and Subsequent Cleanup</h2>
<p>To improve efficiency and conserve memory, it is essential to regularly check for dead clients and free up any system resources associated with them. This includes, untuning all (if any) ongoing tune request issued by this client and freeing up the memory used to store client specific data (Example: client's list of requests (handles), health, permissions, threads associated with the client etc). URM ensures that such clients are detected and cleaned up within 90 seconds of the client terminated.</p>
<p>URM performs these actions by making use of two components:</p><ul>
<li>Pulse check: scans the list of the active clients, and checks if any of the client (PID) is dead. If it finds a dead client, it schedules the cleanup by adding this PID to a queue.</li>
<li>Garbage collection: When the thread runs it iterates over the GC queue and performs the cleanup.</li>
</ul>
<p>Pulse Monitor runs on a separate thread peroidically.</p>
<h2><a class="anchor" id="autotoc_md64"></a>
7.7. Rate Limiter: Preventing System Abuse</h2>
<p>URM has a rate limiter module that prevents abuse of the system by limiting the number of requests a client can make within a given time frame. This helps to prevent clients from overwhelming the system with requests and ensures that the system remains responsive and efficient. Rate limiter works on a reward/punishment methodology. Whenever a client requests the system for the first time, it is assigned a "Health" of 100. A punishment is handed over if a client makes subsequent new requests in a very short time interval (called delta, say 2 ms). A Reward results in increasing the health of a client (not above 100), while a punishment involves decreasing the health of the client. If at any point this value of Health reaches zero then any further requests from this client wil be dropped. Value of delta, punishment and rewards are target-configurable.</p>
<h2><a class="anchor" id="autotoc_md65"></a>
7.8. Duplicate Checking</h2>
<p>URM's <a class="el" href="classRequestManager.html" title="RequestManager.">RequestManager</a> component is responsible for detecting any duplicate requests issued by a client, and dropping them. This is done by checking against a list of all the requests issued by a client to identify a duplicate. If it is, then the request is dropped. If it is not, then the request is added and processed. Duplicate checking helps to improve system efficiency, by saving wasteful CPU time on processing duplicates.</p>
<h2><a class="anchor" id="autotoc_md66"></a>
7.9. Dynamic Mapper: Logical to Physical Mapping</h2>
<p>Logical to physical core/cluster mapping helps to achieve application code portability across different chipsets on client side. Client can specify logical values for core and cluster. URM will translate these values to their physical counterparts and apply the request accordingly. Logical to physical mapping helps to create system independent layer and helps to make the same client code interchangable across different targets.</p>
<p>Logical mapping entries can be found in InitConfig.yaml and can be modified if required.</p>
<p>Logical layer values always arranged from lower to higher cluster capacities. If no names assigned to entries in the dynamic mapping table then cluster'number' will be the name of the cluster for ex. LgcId 4 named as "cluster4"</p>
<p>below table present in InitConfigs-&gt;ClusterMap section </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">LgcId   </th><th class="markdownTableHeadNone">Name    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">"little"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">"big"    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">"prime"   </td></tr>
</table>
<p>URM reads machine topology and prepares logical to physical table dynamically in the init phase, similar to below one </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">LgcId   </th><th class="markdownTableHeadNone">PhyId    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">0    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">1    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">2   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md67"></a>
7.10. Display-Aware Operational Modes</h2>
<p>The system's operational modes are influenced by the state of the device's display. To conserve power, certain system resources are optimized only when the display is active. However, for critical components that require consistent performance—such as during background processing or time-sensitive tasks, resource tuning can still be applied even when the display is off, including during low-power states like doze mode. This ensures that essential operations maintain responsiveness without compromising overall energy efficiency.</p>
<h2><a class="anchor" id="autotoc_md68"></a>
7.11. Crash Recovery</h2>
<p>In case of server crash, URM ensures that all the resource sysfs nodes are restored to a sane state, i.e. they are reset to their original values. This is done by maintaining a backup of all the resource's original values, before any modification was made on behalf of the clients by urm. In the event of server crash, reset to their original values in the backup.</p>
<h2><a class="anchor" id="autotoc_md69"></a>
7.12. Flexible Packaging</h2>
<p>The Users are free to pick and choose the URM modules they want for their use-case and which fit their constraints. The Framework Module is the core/central module, however if the users choose they can add on top of it other Modules: signals and profiles.</p>
<h2><a class="anchor" id="autotoc_md70"></a>
7.13. Pre-Allocate Capacity for efficiency</h2>
<p>URM provides a MemoryPool component, which allows for pre-allocation of memory for certain commonly used type at the time of server initialization. This is done to improve the efficiency of the system, by reducing the number of memory allocations and deallocations that are required during the processing of requests. The allocated memory is managed as a series of blocks which can be recycled without any system call overhead. This reduces the overhead of memory allocation and deallocation, and improves the performance of the system.</p>
<p>Further, a ThreadPool component is provided to pre-allocate processing capacity. This is done to improve the efficiency of the system, by reducing the number of thread creation and destruction required during the processing of Requests, further ThreadPool allows for the threads to be repeatedly reused for processing different tasks.</p>
<h1><a class="anchor" id="autotoc_md71"></a>
8. Contact</h1>
<p>For questions, suggestions, or contributions, feel free to reach out:</p>
<ul>
<li><b>Email</b>: <a href="#" onclick="location.href='mai'+'lto:'+'Mai'+'nt'+'ain'+'er'+'s.u'+'se'+'rsp'+'ac'+'e-r'+'es'+'our'+'ce'+'-mo'+'de'+'rat'+'or'+'@qt'+'i.'+'qua'+'lc'+'omm'+'.c'+'om'; return false;">Maint<span class="obfuscator">.nosp@m.</span>aine<span class="obfuscator">.nosp@m.</span>rs.us<span class="obfuscator">.nosp@m.</span>ersp<span class="obfuscator">.nosp@m.</span>ace-r<span class="obfuscator">.nosp@m.</span>esou<span class="obfuscator">.nosp@m.</span>rce-m<span class="obfuscator">.nosp@m.</span>oder<span class="obfuscator">.nosp@m.</span>ator@<span class="obfuscator">.nosp@m.</span>qti.<span class="obfuscator">.nosp@m.</span>qualc<span class="obfuscator">.nosp@m.</span>omm.<span class="obfuscator">.nosp@m.</span>com</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md72"></a>
9. License</h1>
<p>This project is licensed under the BSD 3-Clause Clear License.</p>
<div style="page-break-after: always;"></div> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Jan 29 2026 05:48:40 for Userspace Resource Manager by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
